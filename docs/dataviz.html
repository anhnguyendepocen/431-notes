<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 NHANES: Initial Exploring | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</title>
  <meta name="description" content="This book describes some fundamental approaches to doing biostatistical and data science in research." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 NHANES: Initial Exploring | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book describes some fundamental approaches to doing biostatistical and data science in research." />
  <meta name="github-repo" content="thomaselove/431-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 NHANES: Initial Exploring | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431" />
  
  <meta name="twitter:description" content="This book describes some fundamental approaches to doing biostatistical and data science in research." />
  

<meta name="author" content="Thomas E. Love" />


<meta name="date" content="2020-08-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="looking-at-the-palmer-penguins.html"/>
<link rel="next" href="data-structures-and-types-of-variables.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dr. Love's Notes for 431</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Working with These Notes</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-431-course-online"><i class="fa fa-check"></i>The 431 Course online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-youll-find-here"><i class="fa fa-check"></i>What You’ll Find Here</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#setting-up-r"><i class="fa fa-check"></i>Setting Up R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#initial-setup-of-r-packages"><i class="fa fa-check"></i>Initial Setup of R Packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#additional-r-packages-installed-for-this-book"><i class="fa fa-check"></i>Additional R Packages installed for this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>1</b> Data Science</a><ul>
<li class="chapter" data-level="1.1" data-path="data-science.html"><a href="data-science.html#data-science-project-cycle"><i class="fa fa-check"></i><b>1.1</b> Data Science Project Cycle</a></li>
<li class="chapter" data-level="1.2" data-path="data-science.html"><a href="data-science.html#data-science-and-the-431-course"><i class="fa fa-check"></i><b>1.2</b> Data Science and the 431 Course</a></li>
<li class="chapter" data-level="1.3" data-path="data-science.html"><a href="data-science.html#what-the-course-is-and-isnt"><i class="fa fa-check"></i><b>1.3</b> What The Course Is and Isn’t</a></li>
</ul></li>
<li class="part"><span><b>Part A. Exploring Data</b></span></li>
<li class="chapter" data-level="2" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html"><i class="fa fa-check"></i><b>2</b> Looking at the Palmer Penguins</a><ul>
<li class="chapter" data-level="2.1" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#package-loading-then-dealing-with-missing-data"><i class="fa fa-check"></i><b>2.1</b> Package Loading, then Dealing with Missing Data</a></li>
<li class="chapter" data-level="2.2" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#counting-things-and-making-tables"><i class="fa fa-check"></i><b>2.2</b> Counting Things and Making Tables</a></li>
<li class="chapter" data-level="2.3" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#visualizing-the-data-in-a-graph-or-a-few"><i class="fa fa-check"></i><b>2.3</b> Visualizing the Data in a Graph (or a few…)</a></li>
<li class="chapter" data-level="2.4" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#six-ways-to-improve-this-graph"><i class="fa fa-check"></i><b>2.4</b> Six Ways To “Improve” This Graph</a></li>
<li class="chapter" data-level="2.5" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#a-little-reflection"><i class="fa fa-check"></i><b>2.5</b> A Little Reflection</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> NHANES: Initial Exploring</a><ul>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#the-nhanes-data-collecting-a-sample"><i class="fa fa-check"></i><b>3.1</b> The NHANES data: Collecting a Sample</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#age-and-height"><i class="fa fa-check"></i><b>3.2</b> Age and Height</a></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#subset-of-subjects-with-known-age-and-height"><i class="fa fa-check"></i><b>3.3</b> Subset of Subjects with Known Age and Height</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#the-distinction-between-gender-and-sex"><i class="fa fa-check"></i><b>3.3.1</b> The Distinction between <code>Gender</code> and <code>Sex</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#age-height-and-sex"><i class="fa fa-check"></i><b>3.4</b> Age-Height and Sex?</a><ul>
<li class="chapter" data-level="3.4.1" data-path="dataviz.html"><a href="dataviz.html#can-we-show-the-female-and-male-relationships-in-separate-panels"><i class="fa fa-check"></i><b>3.4.1</b> Can we show the Female and Male relationships in separate panels?</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataviz.html"><a href="dataviz.html#can-we-add-a-smooth-curve-to-show-the-relationship-in-each-plot"><i class="fa fa-check"></i><b>3.4.2</b> Can we add a smooth curve to show the relationship in each plot?</a></li>
<li class="chapter" data-level="3.4.3" data-path="dataviz.html"><a href="dataviz.html#what-if-we-want-to-assume-straight-line-relationships"><i class="fa fa-check"></i><b>3.4.3</b> What if we want to assume straight line relationships?</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataviz.html"><a href="dataviz.html#creating-a-new-subset-ages-21-79"><i class="fa fa-check"></i><b>3.5</b> Creating A New Subset: Ages 21-79</a></li>
<li class="chapter" data-level="3.6" data-path="dataviz.html"><a href="dataviz.html#distribution-of-heights"><i class="fa fa-check"></i><b>3.6</b> Distribution of Heights</a><ul>
<li class="chapter" data-level="3.6.1" data-path="dataviz.html"><a href="dataviz.html#changing-a-histograms-fill-and-color"><i class="fa fa-check"></i><b>3.6.1</b> Changing a Histogram’s Fill and Color</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dataviz.html"><a href="dataviz.html#height-and-sex"><i class="fa fa-check"></i><b>3.7</b> Height and Sex</a><ul>
<li class="chapter" data-level="3.7.1" data-path="dataviz.html"><a href="dataviz.html#a-boxplot-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.1</b> A Boxplot of Height by Sex</a></li>
<li class="chapter" data-level="3.7.2" data-path="dataviz.html"><a href="dataviz.html#histograms-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.2</b> Histograms of Height by Sex</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="dataviz.html"><a href="dataviz.html#looking-at-pulse-rate"><i class="fa fa-check"></i><b>3.8</b> Looking at Pulse Rate</a><ul>
<li class="chapter" data-level="3.8.1" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-physical-activity"><i class="fa fa-check"></i><b>3.8.1</b> Pulse Rate and Physical Activity</a></li>
<li class="chapter" data-level="3.8.2" data-path="dataviz.html"><a href="dataviz.html#pulse-by-sleeping-trouble"><i class="fa fa-check"></i><b>3.8.2</b> Pulse by Sleeping Trouble</a></li>
<li class="chapter" data-level="3.8.3" data-path="dataviz.html"><a href="dataviz.html#pulse-and-healthgen"><i class="fa fa-check"></i><b>3.8.3</b> Pulse and HealthGen</a></li>
<li class="chapter" data-level="3.8.4" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-systolic-blood-pressure"><i class="fa fa-check"></i><b>3.8.4</b> Pulse Rate and Systolic Blood Pressure</a></li>
<li class="chapter" data-level="3.8.5" data-path="dataviz.html"><a href="dataviz.html#sleep-troubls-vs.-no-sleep-trouble"><i class="fa fa-check"></i><b>3.8.5</b> Sleep Troubls vs. No Sleep Trouble?</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="dataviz.html"><a href="dataviz.html#general-health-status"><i class="fa fa-check"></i><b>3.9</b> General Health Status</a><ul>
<li class="chapter" data-level="3.9.1" data-path="dataviz.html"><a href="dataviz.html#bar-chart-for-categorical-data"><i class="fa fa-check"></i><b>3.9.1</b> Bar Chart for Categorical Data</a></li>
<li class="chapter" data-level="3.9.2" data-path="dataviz.html"><a href="dataviz.html#working-with-tables"><i class="fa fa-check"></i><b>3.9.2</b> Working with Tables</a></li>
<li class="chapter" data-level="3.9.3" data-path="dataviz.html"><a href="dataviz.html#sbp-by-general-health-status"><i class="fa fa-check"></i><b>3.9.3</b> SBP by General Health Status</a></li>
<li class="chapter" data-level="3.9.4" data-path="dataviz.html"><a href="dataviz.html#sbp-by-physical-activity-and-general-health-status"><i class="fa fa-check"></i><b>3.9.4</b> SBP by Physical Activity and General Health Status</a></li>
<li class="chapter" data-level="3.9.5" data-path="dataviz.html"><a href="dataviz.html#sbp-by-sleep-trouble-and-general-health-status"><i class="fa fa-check"></i><b>3.9.5</b> SBP by Sleep Trouble and General Health Status</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="dataviz.html"><a href="dataviz.html#conclusions"><i class="fa fa-check"></i><b>3.10</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html"><i class="fa fa-check"></i><b>4</b> Data Structures and Types of Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#data-require-structure-and-context"><i class="fa fa-check"></i><b>4.1</b> Data require structure and context</a></li>
<li class="chapter" data-level="4.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#newNHANES"><i class="fa fa-check"></i><b>4.2</b> A New NHANES Adult Sample</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#summarizing-the-datas-structure"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing the Data’s Structure</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#what-are-the-variables"><i class="fa fa-check"></i><b>4.2.2</b> What are the variables?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#quantitative-variables"><i class="fa fa-check"></i><b>4.3</b> Quantitative Variables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#a-look-at-bmi-body-mass-index"><i class="fa fa-check"></i><b>4.3.1</b> A look at BMI (Body-Mass Index)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#qualitative-categorical-variables"><i class="fa fa-check"></i><b>4.4</b> Qualitative (Categorical) Variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html"><i class="fa fa-check"></i><b>5</b> Summarizing Quantitative Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-summary-function-for-quantitative-data"><i class="fa fa-check"></i><b>5.1</b> The <code>summary</code> function for Quantitative data</a></li>
<li class="chapter" data-level="5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-center-of-a-distribution"><i class="fa fa-check"></i><b>5.2</b> Measuring the Center of a Distribution</a><ul>
<li class="chapter" data-level="5.2.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mean-and-the-median"><i class="fa fa-check"></i><b>5.2.1</b> The Mean and The Median</a></li>
<li class="chapter" data-level="5.2.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#dealing-with-missingness"><i class="fa fa-check"></i><b>5.2.2</b> Dealing with Missingness</a></li>
<li class="chapter" data-level="5.2.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mode-of-a-quantitative-variable"><i class="fa fa-check"></i><b>5.2.3</b> The Mode of a Quantitative Variable</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-spread-of-a-distribution"><i class="fa fa-check"></i><b>5.3</b> Measuring the Spread of a Distribution</a><ul>
<li class="chapter" data-level="5.3.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#rangeandiqr"><i class="fa fa-check"></i><b>5.3.1</b> The Range and the Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="5.3.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-variance-and-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.2</b> The Variance and the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#obtaining-the-variance-and-standard-deviation-in-r"><i class="fa fa-check"></i><b>5.3.3</b> Obtaining the Variance and Standard Deviation in R</a></li>
<li class="chapter" data-level="5.3.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#defining-the-variance-and-standard-deviation"><i class="fa fa-check"></i><b>5.3.4</b> Defining the Variance and Standard Deviation</a></li>
<li class="chapter" data-level="5.3.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#empirical-rule-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.5</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.6" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#chebyshevs-inequality-one-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.6</b> Chebyshev’s Inequality: One Interpretation of the Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-shape-of-a-distribution"><i class="fa fa-check"></i><b>5.4</b> Measuring the Shape of a Distribution</a><ul>
<li class="chapter" data-level="5.4.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#multimodal-vs.-unimodal-distributions"><i class="fa fa-check"></i><b>5.4.1</b> Multimodal vs. Unimodal distributions</a></li>
<li class="chapter" data-level="5.4.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#skew"><i class="fa fa-check"></i><b>5.4.2</b> Skew</a></li>
<li class="chapter" data-level="5.4.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#kurtosis"><i class="fa fa-check"></i><b>5.4.3</b> Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#more-detailed-numerical-summaries-for-quantitative-variables"><i class="fa fa-check"></i><b>5.5</b> More Detailed Numerical Summaries for Quantitative Variables</a><ul>
<li class="chapter" data-level="5.5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#favstats-in-the-mosaic-package"><i class="fa fa-check"></i><b>5.5.1</b> <code>favstats</code> in the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="5.5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-psych-package"><i class="fa fa-check"></i><b>5.5.2</b> <code>describe</code> in the <code>psych</code> package</a></li>
<li class="chapter" data-level="5.5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-hmisc-package"><i class="fa fa-check"></i><b>5.5.3</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="5.5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#other-options"><i class="fa fa-check"></i><b>5.5.4</b> Other options</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html"><i class="fa fa-check"></i><b>6</b> Summarizing Categorical Variables</a><ul>
<li class="chapter" data-level="6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-summary-function-for-categorical-data"><i class="fa fa-check"></i><b>6.1</b> The <code>summary</code> function for Categorical data</a></li>
<li class="chapter" data-level="6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#tables-to-describe-one-categorical-variable"><i class="fa fa-check"></i><b>6.2</b> Tables to describe One Categorical Variable</a></li>
<li class="chapter" data-level="6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-mode-of-a-categorical-variable"><i class="fa fa-check"></i><b>6.3</b> The Mode of a Categorical Variable</a></li>
<li class="chapter" data-level="6.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-hmisc-package"><i class="fa fa-check"></i><b>6.4</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="6.5" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-tabulations"><i class="fa fa-check"></i><b>6.5</b> Cross-Tabulations</a><ul>
<li class="chapter" data-level="6.5.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-classifying-three-categorical-variables"><i class="fa fa-check"></i><b>6.5.1</b> Cross-Classifying Three Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#constructing-tables-well"><i class="fa fa-check"></i><b>6.6</b> Constructing Tables Well</a><ul>
<li class="chapter" data-level="6.6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#alabama-first"><i class="fa fa-check"></i><b>6.6.1</b> Alabama First!</a></li>
<li class="chapter" data-level="6.6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#order-rows-and-columns-sensibly"><i class="fa fa-check"></i><b>6.6.2</b> Order rows and columns sensibly</a></li>
<li class="chapter" data-level="6.6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#round---a-lot"><i class="fa fa-check"></i><b>6.6.3</b> Round - a lot!</a></li>
<li class="chapter" data-level="6.6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#all-is-different-and-important"><i class="fa fa-check"></i><b>6.6.4</b> ALL is different and important</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#gaining-control-over-tables-in-r-the-gt-package"><i class="fa fa-check"></i><b>6.7</b> Gaining Control over Tables in R: the <code>gt</code> package</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dataviz" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> NHANES: Initial Exploring</h1>
<p>We’ll start by visualizing some data from the US National Health and Nutrition Examination Survey, or NHANES. We’ll display R code as we go, but we’ll return to all of the key coding ideas involved later in the Notes.</p>
<div id="the-nhanes-data-collecting-a-sample" class="section level2">
<h2><span class="header-section-number">3.1</span> The NHANES data: Collecting a Sample</h2>
<p>To begin, we’ll gather a random sample of 1,000 subjects participating in NHANES, and then identify several variables of interest about those subjects<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Some of the motivation for this example came from a Figure in <span class="citation">Baumer, Kaplan, and Horton (<a href="#ref-BaumerKaplanHorton" role="doc-biblioref">2017</a>)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="dataviz.html#cb15-1"></a><span class="co"># library(NHANES) # already loaded NHANES package/library of functions, data</span></span>
<span id="cb15-2"><a href="dataviz.html#cb15-2"></a></span>
<span id="cb15-3"><a href="dataviz.html#cb15-3"></a><span class="kw">set.seed</span>(<span class="dv">431001</span>) </span>
<span id="cb15-4"><a href="dataviz.html#cb15-4"></a><span class="co"># use set.seed to ensure that we all get the same random sample </span></span>
<span id="cb15-5"><a href="dataviz.html#cb15-5"></a><span class="co"># of 1,000 NHANES subjects in our nh_data collection</span></span>
<span id="cb15-6"><a href="dataviz.html#cb15-6"></a></span>
<span id="cb15-7"><a href="dataviz.html#cb15-7"></a>nh_dat1 &lt;-<span class="st"> </span><span class="kw">sample_n</span>(NHANES, <span class="dt">size =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-8"><a href="dataviz.html#cb15-8"></a><span class="st">    </span><span class="kw">select</span>(ID, Gender, Age, Height) </span>
<span id="cb15-9"><a href="dataviz.html#cb15-9"></a></span>
<span id="cb15-10"><a href="dataviz.html#cb15-10"></a>nh_dat1</span></code></pre></div>
<pre><code># A tibble: 1,000 x 4
      ID Gender   Age Height
   &lt;int&gt; &lt;fct&gt;  &lt;int&gt;  &lt;dbl&gt;
 1 69638 female     5   106.
 2 70782 male      64   176.
 3 52408 female    54   162.
 4 59031 female    15   155.
 5 64530 male      53   185.
 6 71040 male      63   169.
 7 55186 female    30   168.
 8 60211 male       5   103.
 9 55730 male      66   161.
10 68229 female    36   170.
# ... with 990 more rows</code></pre>
<p>We have 1000 rows (observations) and 4 columns (variables) that describe the subjects listed in the rows.</p>
</div>
<div id="age-and-height" class="section level2">
<h2><span class="header-section-number">3.2</span> Age and Height</h2>
<p>Suppose we want to visualize the relationship of Height and Age in our 1,000 NHANES observations. The best choice is likely to be a scatterplot.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="dataviz.html#cb17-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat1, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Height)) <span class="op">+</span></span>
<span id="cb17-2"><a href="dataviz.html#cb17-2"></a><span class="st">    </span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<p><img src="431-notes_files/figure-html/nh_dat1_heightbyage1-fig-1.png" width="672" /></p>
<p>We note several interesting results here.</p>
<ol style="list-style-type: decimal">
<li>As a warning, R tells us that it has “Removed 37 rows containing missing values (geom_point).” Only 963 subjects plotted here, because the remaining 37 people have missing (NA) values for either Height, Age or both.</li>
<li>Unsurprisingly, the measured Heights of subjects grow from Age 0 to Age 20 or so, and we see that a typical Height increases rapidly across these Ages. The middle of the distribution at later Ages is pretty consistent at at a Height somewhere between 150 and 175. The units aren’t specified, but we expect they must be centimeters. The Ages are clearly reported in Years.</li>
<li>No Age is reported over 80, and it appears that there is a large cluster of Ages at 80. This may be due to a requirement that Ages 80 and above be reported at 80 so as to help mask the identity of those individuals.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></li>
</ol>
<p>As in this case, we’re going to build most of our visualizations using tools from the <code>ggplot2</code> package, which is part of the <code>tidyverse</code> series of packages. You’ll see similar coding structures throughout this Chapter, most of which are covered as well in Chapter 3 of <span class="citation">Grolemund and Wickham (<a href="#ref-R4DS" role="doc-biblioref">2019</a>)</span>.</p>
</div>
<div id="subset-of-subjects-with-known-age-and-height" class="section level2">
<h2><span class="header-section-number">3.3</span> Subset of Subjects with Known Age and Height</h2>
<p>Before we move on, let’s manipulate the data set a bit, to focus on only those subjects who have complete data on both Age and Height. This will help us avoid that warning message.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="dataviz.html#cb19-1"></a>nh_dat2 &lt;-<span class="st"> </span>nh_dat1 <span class="op">%&gt;%</span></span>
<span id="cb19-2"><a href="dataviz.html#cb19-2"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(Age, Height)) </span>
<span id="cb19-3"><a href="dataviz.html#cb19-3"></a></span>
<span id="cb19-4"><a href="dataviz.html#cb19-4"></a><span class="kw">summary</span>(nh_dat2)</span></code></pre></div>
<pre><code>       ID           Gender         Age            Height     
 Min.   :51624   female:484   Min.   : 2.00   Min.   : 85.0  
 1st Qu.:57034   male  :479   1st Qu.:19.00   1st Qu.:156.2  
 Median :62056                Median :37.00   Median :165.0  
 Mean   :61967                Mean   :38.29   Mean   :162.3  
 3rd Qu.:67269                3rd Qu.:56.00   3rd Qu.:174.5  
 Max.   :71875                Max.   :80.00   Max.   :195.9  </code></pre>
<p>Note that the units and explanations for these variables are contained in the NHANES help file, available via typing <code>?NHANES</code> in the Console of R Studio, or by typing <code>NHANES</code> into the Search bar in R Studio’s Help window.</p>
<div id="the-distinction-between-gender-and-sex" class="section level3">
<h3><span class="header-section-number">3.3.1</span> The Distinction between <code>Gender</code> and <code>Sex</code></h3>
<p>The <code>Gender</code> variable here is a mistake. These data refer to the biological status of these subjects, which is their <code>Sex</code>, and not the social construct of <code>Gender</code> which can be quite different. In our effort to avoid further confusion, we’ll rename the variable <code>Gender</code> to instead more accurately describe what is actually measured here.</p>
<p>To do this, we can use this approach…</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="dataviz.html#cb21-1"></a>nh_dat2 &lt;-<span class="st"> </span>nh_dat1 <span class="op">%&gt;%</span></span>
<span id="cb21-2"><a href="dataviz.html#cb21-2"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">Sex =</span> Gender) <span class="op">%&gt;%</span></span>
<span id="cb21-3"><a href="dataviz.html#cb21-3"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(Age, Height)) </span>
<span id="cb21-4"><a href="dataviz.html#cb21-4"></a></span>
<span id="cb21-5"><a href="dataviz.html#cb21-5"></a><span class="kw">summary</span>(nh_dat2)</span></code></pre></div>
<pre><code>       ID            Sex           Age            Height     
 Min.   :51624   female:484   Min.   : 2.00   Min.   : 85.0  
 1st Qu.:57034   male  :479   1st Qu.:19.00   1st Qu.:156.2  
 Median :62056                Median :37.00   Median :165.0  
 Mean   :61967                Mean   :38.29   Mean   :162.3  
 3rd Qu.:67269                3rd Qu.:56.00   3rd Qu.:174.5  
 Max.   :71875                Max.   :80.00   Max.   :195.9  </code></pre>
<p>That’s better. How many observations do we have now? We could use <code>dim</code> to find out the number of rows and columns in this new data set.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="dataviz.html#cb23-1"></a><span class="kw">dim</span>(nh_dat2)</span></code></pre></div>
<pre><code>[1] 963   4</code></pre>
<p>Or, we could simply list the data set and read off the result.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="dataviz.html#cb25-1"></a>nh_dat2</span></code></pre></div>
<pre><code># A tibble: 963 x 4
      ID Sex      Age Height
   &lt;int&gt; &lt;fct&gt;  &lt;int&gt;  &lt;dbl&gt;
 1 69638 female     5   106.
 2 70782 male      64   176.
 3 52408 female    54   162.
 4 59031 female    15   155.
 5 64530 male      53   185.
 6 71040 male      63   169.
 7 55186 female    30   168.
 8 60211 male       5   103.
 9 55730 male      66   161.
10 68229 female    36   170.
# ... with 953 more rows</code></pre>
</div>
</div>
<div id="age-height-and-sex" class="section level2">
<h2><span class="header-section-number">3.4</span> Age-Height and Sex?</h2>
<p>Let’s add Sex to the plot using color, and also adjust the y axis label to incorporate the units of measurement.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="dataviz.html#cb27-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat2, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Height, <span class="dt">color =</span> Sex)) <span class="op">+</span></span>
<span id="cb27-2"><a href="dataviz.html#cb27-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb27-3"><a href="dataviz.html#cb27-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height-Age Relationship in NHANES sample&quot;</span>, </span>
<span id="cb27-4"><a href="dataviz.html#cb27-4"></a>         <span class="dt">y =</span> <span class="st">&quot;Height in cm.&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat2_heightbyageandsex1-fig-1.png" width="672" /></p>
<div id="can-we-show-the-female-and-male-relationships-in-separate-panels" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Can we show the Female and Male relationships in separate panels?</h3>
<p>Sure.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="dataviz.html#cb28-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat2, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Height, <span class="dt">color =</span> Sex)) <span class="op">+</span></span>
<span id="cb28-2"><a href="dataviz.html#cb28-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-3"><a href="dataviz.html#cb28-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height-Age Relationship in NHANES sample&quot;</span>, </span>
<span id="cb28-4"><a href="dataviz.html#cb28-4"></a>         <span class="dt">y =</span> <span class="st">&quot;Height in cm.&quot;</span>) <span class="op">+</span></span>
<span id="cb28-5"><a href="dataviz.html#cb28-5"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat2_heightbyageandsex2-fig-1.png" width="672" /></p>
</div>
<div id="can-we-add-a-smooth-curve-to-show-the-relationship-in-each-plot" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Can we add a smooth curve to show the relationship in each plot?</h3>
<p>Yep, and let’s change the theme of the graph to remove the gray background, too.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="dataviz.html#cb29-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat2, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Height, <span class="dt">color =</span> Sex)) <span class="op">+</span></span>
<span id="cb29-2"><a href="dataviz.html#cb29-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-3"><a href="dataviz.html#cb29-3"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb29-4"><a href="dataviz.html#cb29-4"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height-Age Relationship in NHANES sample&quot;</span>, </span>
<span id="cb29-5"><a href="dataviz.html#cb29-5"></a>         <span class="dt">y =</span> <span class="st">&quot;Height in cm.&quot;</span>) <span class="op">+</span></span>
<span id="cb29-6"><a href="dataviz.html#cb29-6"></a><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb29-7"><a href="dataviz.html#cb29-7"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="431-notes_files/figure-html/nh_dat2_heightbyageandsex3-fig-1.png" width="672" /></p>
</div>
<div id="what-if-we-want-to-assume-straight-line-relationships" class="section level3">
<h3><span class="header-section-number">3.4.3</span> What if we want to assume straight line relationships?</h3>
<p>We could look at a linear model in the plot. Does this make sense here?</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="dataviz.html#cb31-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat2, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Height, <span class="dt">color =</span> Sex)) <span class="op">+</span></span>
<span id="cb31-2"><a href="dataviz.html#cb31-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-3"><a href="dataviz.html#cb31-3"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb31-4"><a href="dataviz.html#cb31-4"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height-Age Relationship in NHANES sample&quot;</span>, </span>
<span id="cb31-5"><a href="dataviz.html#cb31-5"></a>         <span class="dt">y =</span> <span class="st">&quot;Height in cm.&quot;</span>) <span class="op">+</span></span>
<span id="cb31-6"><a href="dataviz.html#cb31-6"></a><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb31-7"><a href="dataviz.html#cb31-7"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="431-notes_files/figure-html/nh_dat2_heightbyageandsex4-fig-1.png" width="672" /></p>
</div>
</div>
<div id="creating-a-new-subset-ages-21-79" class="section level2">
<h2><span class="header-section-number">3.5</span> Creating A New Subset: Ages 21-79</h2>
<p>Suppose we wanted to look only at those observations (subjects) whose Age is at least 21 and at most 79. Suppose also that we want to look at some of the additional variables available in NHANES. To start, we’ll do the following:</p>
<ol style="list-style-type: decimal">
<li>Set the same seed for random sampling that we used earlier, so that we start with the original sample of 1000 people we built earlier. Draw that same sample of 1,000 people.</li>
<li>Filter the sample to only those people whose age is more than 20 and less than 80 years.</li>
<li>Select the variables we will use in the rest of this chapter:
<ul>
<li><code>Age</code> as we’ve seen before, in years.</li>
<li><code>Height</code> as we’ve seen before, in centimeters.</li>
<li><code>Gender</code> which we’ll rename as <code>Sex</code> again.</li>
<li><code>Pulse</code> = 60 second pulse rate (in beats per minute).</li>
<li><code>BPSysAve</code> = Systolic Blood Pressure, in mm Hg (and we’ll rename this <code>SBP</code>).</li>
<li><code>SleepTrouble</code> = Yes means the subject has told a health professional that they had trouble sleeping.</li>
<li><code>PhysActive</code> = Yes means the subject does moderate or vigorous-intensity sports, fitness or recreational activity.</li>
<li><code>MaritalStatus</code> = one of Married, Widowed, Divorced, Separated, NeverMarried or LivePartner (living with partner.)</li>
<li><code>HealthGen</code> = self-reported rating of general health, one of Excellent, Vgood (Very Good), Good, Fair or Poor.</li>
</ul></li>
<li>Rename <code>Gender</code> as <code>Sex</code>, to more accurately describe what is being measured.</li>
<li>Omit subjects with any missingness on <em>any</em> of the variables we’ve selected.</li>
</ol>
<p>Can you see how the code below accomplishes these tasks?</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="dataviz.html#cb33-1"></a><span class="kw">set.seed</span>(<span class="dv">431001</span>) <span class="co"># again, this will ensure the same sample</span></span>
<span id="cb33-2"><a href="dataviz.html#cb33-2"></a></span>
<span id="cb33-3"><a href="dataviz.html#cb33-3"></a>nh_dat3 &lt;-<span class="st"> </span><span class="kw">sample_n</span>(NHANES, <span class="dt">size =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span></span>
<span id="cb33-4"><a href="dataviz.html#cb33-4"></a><span class="st">    </span><span class="kw">filter</span>(Age <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span> <span class="op">&amp;</span><span class="st"> </span>Age <span class="op">&lt;</span><span class="st"> </span><span class="dv">80</span>) <span class="op">%&gt;%</span></span>
<span id="cb33-5"><a href="dataviz.html#cb33-5"></a><span class="st">    </span><span class="kw">select</span>(ID, Gender, Age, Height, </span>
<span id="cb33-6"><a href="dataviz.html#cb33-6"></a>           Pulse, BPSysAve, SleepTrouble, PhysActive,</span>
<span id="cb33-7"><a href="dataviz.html#cb33-7"></a>           MaritalStatus, HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb33-8"><a href="dataviz.html#cb33-8"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">Sex =</span> Gender, <span class="dt">SBP =</span> BPSysAve) <span class="op">%&gt;%</span></span>
<span id="cb33-9"><a href="dataviz.html#cb33-9"></a><span class="st">    </span>na.omit</span>
<span id="cb33-10"><a href="dataviz.html#cb33-10"></a></span>
<span id="cb33-11"><a href="dataviz.html#cb33-11"></a>nh_dat3</span></code></pre></div>
<pre><code># A tibble: 603 x 10
      ID Sex     Age Height Pulse   SBP SleepTrouble PhysActive MaritalStatus
   &lt;int&gt; &lt;fct&gt; &lt;int&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;fct&gt;        &lt;fct&gt;      &lt;fct&gt;        
 1 70782 male     64   176.    78   127 No           No         Married      
 2 52408 fema~    54   162.    80   135 No           No         LivePartner  
 3 64530 male     53   185.   100   131 No           No         Married      
 4 71040 male     63   169.    70   124 Yes          Yes        Married      
 5 55186 fema~    30   168.    76   107 No           No         Married      
 6 55730 male     66   161.    78   133 No           No         Married      
 7 68229 fema~    36   170.    90   105 No           Yes        Married      
 8 63762 male     23   180.    66   118 No           No         Married      
 9 66290 fema~    63   162.    88   116 No           No         Married      
10 66984 male     75   174.    84   141 No           No         Married      
# ... with 593 more rows, and 1 more variable: HealthGen &lt;fct&gt;</code></pre>
</div>
<div id="distribution-of-heights" class="section level2">
<h2><span class="header-section-number">3.6</span> Distribution of Heights</h2>
<p>What is the distribution of height in this new sample?</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="dataviz.html#cb35-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Height)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-2"><a href="dataviz.html#cb35-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>() </span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="431-notes_files/figure-html/nh_dat3_heighthistogram-fig-1.png" width="672" /></p>
<p>We can do several things to clean this up.</p>
<ol style="list-style-type: decimal">
<li>We’ll change the color of the lines for each bar of the histogram.</li>
<li>We’ll change the fill inside each bar to make them stand out a bit more.</li>
<li>We’ll add a title and relabel the horizontal (x) axis to include the units of measurement.</li>
<li>We’ll avoid the warning by selecting a number of bins (we’ll use 25 here) into which we’ll group the heights before drawing the histogram.</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="dataviz.html#cb37-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Height)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-2"><a href="dataviz.html#cb37-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">25</span>, <span class="dt">col =</span> <span class="st">&quot;yellow&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-3"><a href="dataviz.html#cb37-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height of NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb37-4"><a href="dataviz.html#cb37-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Height in cm.&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_heighthistogram2-fig-1.png" width="672" /></p>
<div id="changing-a-histograms-fill-and-color" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Changing a Histogram’s Fill and Color</h3>
<p>The CWRU color guide (<a href="https://case.edu/umc/our-brand/visual-guidelines/" class="uri">https://case.edu/umc/our-brand/visual-guidelines/</a>) lists the HTML color schemes for CWRU blue and CWRU gray. Let’s match that color scheme.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="dataviz.html#cb38-1"></a>cwru.blue &lt;-<span class="st"> &#39;#0a304e&#39;</span></span>
<span id="cb38-2"><a href="dataviz.html#cb38-2"></a>cwru.gray &lt;-<span class="st"> &#39;#626262&#39;</span></span>
<span id="cb38-3"><a href="dataviz.html#cb38-3"></a></span>
<span id="cb38-4"><a href="dataviz.html#cb38-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Height)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-5"><a href="dataviz.html#cb38-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">col =</span> cwru.gray, <span class="dt">fill =</span> cwru.blue) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-6"><a href="dataviz.html#cb38-6"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height of NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb38-7"><a href="dataviz.html#cb38-7"></a>         <span class="dt">x =</span> <span class="st">&quot;Height in cm.&quot;</span>) <span class="op">+</span></span>
<span id="cb38-8"><a href="dataviz.html#cb38-8"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_histogramwithCWRUscheme-fig-1.png" width="672" /></p>
<p>Note the other changes to the graph above.</p>
<ol style="list-style-type: decimal">
<li>We changed the theme to replace the gray background.</li>
<li>We changed the bins for the histogram, to gather observations into groups of 2 cm. each.</li>
</ol>
</div>
</div>
<div id="height-and-sex" class="section level2">
<h2><span class="header-section-number">3.7</span> Height and Sex</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="dataviz.html#cb39-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Sex, <span class="dt">y =</span> Height, <span class="dt">color =</span> Sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-2"><a href="dataviz.html#cb39-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-3"><a href="dataviz.html#cb39-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height by Sex for NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb39-4"><a href="dataviz.html#cb39-4"></a>         <span class="dt">y =</span> <span class="st">&quot;Height in cm.&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_heightbysex1-fig-1.png" width="672" /></p>
<p>This plot isn’t so useful. We can improve things a little by jittering the points horizontally, so that the overlap is reduced.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="dataviz.html#cb40-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Sex, <span class="dt">y =</span> Height, <span class="dt">color =</span> Sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-2"><a href="dataviz.html#cb40-2"></a><span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-3"><a href="dataviz.html#cb40-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Height by Sex (jittered) for NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb40-4"><a href="dataviz.html#cb40-4"></a>         <span class="dt">y =</span> <span class="st">&quot;Height in cm.&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_heightbysex2-fig-1.png" width="672" /></p>
<p>Perhaps it might be better to summarise the distribution in a different way. We might consider a boxplot of the data.</p>
<div id="a-boxplot-of-height-by-sex" class="section level3">
<h3><span class="header-section-number">3.7.1</span> A Boxplot of Height by Sex</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="dataviz.html#cb41-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Sex, <span class="dt">y =</span> Height, <span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-2"><a href="dataviz.html#cb41-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-3"><a href="dataviz.html#cb41-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot of Height by Sex for NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb41-4"><a href="dataviz.html#cb41-4"></a>         <span class="dt">y =</span> <span class="st">&quot;Height in cm.&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_heightbysexbox-fig-1.png" width="672" /></p>
<p>Or perhaps we’d like to see a pair of histograms?</p>
</div>
<div id="histograms-of-height-by-sex" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Histograms of Height by Sex</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="dataviz.html#cb42-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Height, <span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-2"><a href="dataviz.html#cb42-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-3"><a href="dataviz.html#cb42-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram of Height by Sex for NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb42-4"><a href="dataviz.html#cb42-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Height in cm.&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-5"><a href="dataviz.html#cb42-5"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_heightbysexhist-fig-1.png" width="672" /></p>
<p>Can we redraw these histograms so that they are a little more comparable, and to get rid of the unnecessary legend?</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="dataviz.html#cb43-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Height, <span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-2"><a href="dataviz.html#cb43-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-3"><a href="dataviz.html#cb43-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram of Height by Sex for NHANES subjects ages 21-79 (Revised)&quot;</span>,</span>
<span id="cb43-4"><a href="dataviz.html#cb43-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Height in cm.&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-5"><a href="dataviz.html#cb43-5"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb43-6"><a href="dataviz.html#cb43-6"></a><span class="st">    </span><span class="kw">facet_grid</span>(Sex <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_heightbysexhist2-fig-1.png" width="672" /></p>
</div>
</div>
<div id="looking-at-pulse-rate" class="section level2">
<h2><span class="header-section-number">3.8</span> Looking at Pulse Rate</h2>
<p>Let’s look at a different outcome, the <em>pulse rate</em> for our subjects.</p>
<p>Here’s a histogram, again with CWRU colors, for the pulse rates in our sample.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="dataviz.html#cb44-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Pulse)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-2"><a href="dataviz.html#cb44-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">fill =</span> cwru.blue, <span class="dt">col =</span> cwru.gray) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-3"><a href="dataviz.html#cb44-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram of Pulse Rate: NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb44-4"><a href="dataviz.html#cb44-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Pulse Rate (beats per minute)&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_pulse_histbin1-fig-1.png" width="672" /></p>
<p>Suppose we instead bin up groups of 5 beats per minute together as we plot the Pulse rates.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="dataviz.html#cb45-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Pulse)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-2"><a href="dataviz.html#cb45-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">fill =</span> cwru.blue, <span class="dt">col =</span> cwru.gray) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-3"><a href="dataviz.html#cb45-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram of Pulse Rate: NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb45-4"><a href="dataviz.html#cb45-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Pulse Rate (beats per minute)&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_pulse_histbin5-fig-1.png" width="672" /></p>
<p>Which is the more useful representation will depend a lot on what questions you’re trying to answer.</p>
<div id="pulse-rate-and-physical-activity" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Pulse Rate and Physical Activity</h3>
<p>We can also split up our data into groups based on whether the subjects are physically active. Let’s try a boxplot.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="dataviz.html#cb46-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">y =</span> Pulse, <span class="dt">x =</span> PhysActive, <span class="dt">fill =</span> PhysActive)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-2"><a href="dataviz.html#cb46-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-3"><a href="dataviz.html#cb46-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Pulse Rate by Physical Activity Status for NHANES ages 21-79&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_pulse_by_activity_box-fig-1.png" width="672" /></p>
<p>As an accompanying numerical summary, we might ask how many people fall into each of these <code>PhysActive</code> categories, and what is their “average” <code>Pulse</code> rate.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="dataviz.html#cb47-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb47-2"><a href="dataviz.html#cb47-2"></a><span class="st">    </span><span class="kw">group_by</span>(PhysActive) <span class="op">%&gt;%</span></span>
<span id="cb47-3"><a href="dataviz.html#cb47-3"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(), <span class="kw">mean</span>(Pulse), <span class="kw">median</span>(Pulse)) <span class="op">%&gt;%</span></span>
<span id="cb47-4"><a href="dataviz.html#cb47-4"></a><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) </span></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">PhysActive</th>
<th align="right">count</th>
<th align="right">mean(Pulse)</th>
<th align="right">median(Pulse)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
<td align="right">293</td>
<td align="right">74.21</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="right">310</td>
<td align="right">72.37</td>
<td align="right">72</td>
</tr>
</tbody>
</table>
<p>The <code>knitr::kable(digits = 2)</code> piece of this command tells R Markdown to generate a table with some attractive formatting, and rounding any decimals to two figures.</p>
</div>
<div id="pulse-by-sleeping-trouble" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Pulse by Sleeping Trouble</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="dataviz.html#cb49-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> Pulse, <span class="dt">fill =</span> SleepTrouble)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-2"><a href="dataviz.html#cb49-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-3"><a href="dataviz.html#cb49-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram of Pulse Rate by Sleep Trouble for NHANES subjects ages 21-79&quot;</span>,</span>
<span id="cb49-4"><a href="dataviz.html#cb49-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Pulse Rate (beats per minute)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-5"><a href="dataviz.html#cb49-5"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb49-6"><a href="dataviz.html#cb49-6"></a><span class="st">    </span><span class="kw">facet_grid</span>(SleepTrouble <span class="op">~</span><span class="st"> </span>., <span class="dt">labeller =</span> <span class="st">&quot;label_both&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_pulse_by_sleep_histbin1-fig-1.png" width="672" /></p>
<p>How many people fall into each of these <code>SleepTrouble</code> categories, and what is their “average” Pulse rate?</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="dataviz.html#cb50-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb50-2"><a href="dataviz.html#cb50-2"></a><span class="st">    </span><span class="kw">group_by</span>(SleepTrouble) <span class="op">%&gt;%</span></span>
<span id="cb50-3"><a href="dataviz.html#cb50-3"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(), <span class="kw">mean</span>(Pulse), <span class="kw">median</span>(Pulse)) <span class="op">%&gt;%</span></span>
<span id="cb50-4"><a href="dataviz.html#cb50-4"></a><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) </span></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">SleepTrouble</th>
<th align="right">count</th>
<th align="right">mean(Pulse)</th>
<th align="right">median(Pulse)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
<td align="right">457</td>
<td align="right">73.05</td>
<td align="right">72</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="right">146</td>
<td align="right">73.96</td>
<td align="right">72</td>
</tr>
</tbody>
</table>
</div>
<div id="pulse-and-healthgen" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Pulse and HealthGen</h3>
<p>We can compare the distribution of Pulse rate across groups by the subject’s self-reported overall health (<code>HealthGen</code>), as well.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="dataviz.html#cb52-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> HealthGen, <span class="dt">y =</span> Pulse, <span class="dt">fill =</span> HealthGen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb52-2"><a href="dataviz.html#cb52-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb52-3"><a href="dataviz.html#cb52-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Pulse by Self-Reported Overall Health for NHANES ages 21-79&quot;</span>,</span>
<span id="cb52-4"><a href="dataviz.html#cb52-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Pulse Rate&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb52-5"><a href="dataviz.html#cb52-5"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) </span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_pulsebyhealthgen1-fig-1.png" width="672" /></p>
<p>How many people fall into each of these <code>HealthGen</code> categories, and what is their “average” Pulse rate?</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="dataviz.html#cb53-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb53-2"><a href="dataviz.html#cb53-2"></a><span class="st">    </span><span class="kw">group_by</span>(HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb53-3"><a href="dataviz.html#cb53-3"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(), <span class="kw">mean</span>(Pulse), <span class="kw">median</span>(Pulse)) <span class="op">%&gt;%</span></span>
<span id="cb53-4"><a href="dataviz.html#cb53-4"></a><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) </span></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">HealthGen</th>
<th align="right">count</th>
<th align="right">mean(Pulse)</th>
<th align="right">median(Pulse)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Excellent</td>
<td align="right">64</td>
<td align="right">69.97</td>
<td align="right">69</td>
</tr>
<tr class="even">
<td align="left">Vgood</td>
<td align="right">196</td>
<td align="right">72.81</td>
<td align="right">72</td>
</tr>
<tr class="odd">
<td align="left">Good</td>
<td align="right">238</td>
<td align="right">73.66</td>
<td align="right">72</td>
</tr>
<tr class="even">
<td align="left">Fair</td>
<td align="right">83</td>
<td align="right">74.22</td>
<td align="right">74</td>
</tr>
<tr class="odd">
<td align="left">Poor</td>
<td align="right">22</td>
<td align="right">79.09</td>
<td align="right">77</td>
</tr>
</tbody>
</table>
</div>
<div id="pulse-rate-and-systolic-blood-pressure" class="section level3">
<h3><span class="header-section-number">3.8.4</span> Pulse Rate and Systolic Blood Pressure</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="dataviz.html#cb55-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> SBP, <span class="dt">y =</span> Pulse)) <span class="op">+</span></span>
<span id="cb55-2"><a href="dataviz.html#cb55-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb55-3"><a href="dataviz.html#cb55-3"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb55-4"><a href="dataviz.html#cb55-4"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;SBP vs. Pulse rate for NHANES subjects, ages 21-79&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="431-notes_files/figure-html/nh_dat3_pulsevssbp-fig-1.png" width="672" /></p>
</div>
<div id="sleep-troubls-vs.-no-sleep-trouble" class="section level3">
<h3><span class="header-section-number">3.8.5</span> Sleep Troubls vs. No Sleep Trouble?</h3>
<p>Could we see whether subjects who have described <code>SleepTrouble</code> show different SBP-pulse rate patterns than the subjects who haven’t?</p>
<ul>
<li>Let’s try doing this by changing the shape <em>and</em> the color of the points based on <code>SleepTrouble</code>.</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="dataviz.html#cb57-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, </span>
<span id="cb57-2"><a href="dataviz.html#cb57-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> SBP, <span class="dt">y =</span> Pulse, </span>
<span id="cb57-3"><a href="dataviz.html#cb57-3"></a>           <span class="dt">color =</span> SleepTrouble, <span class="dt">shape =</span> SleepTrouble)) <span class="op">+</span></span>
<span id="cb57-4"><a href="dataviz.html#cb57-4"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb57-5"><a href="dataviz.html#cb57-5"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb57-6"><a href="dataviz.html#cb57-6"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;SBP vs. Pulse rate for NHANES subjects, ages 21-79&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="431-notes_files/figure-html/nh_dat3_sbpvspulsewithsleep-fig-1.png" width="672" /></p>
<p>This plot might be easier to interpret if we faceted by <code>SleepTrouble</code>, as well.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="dataviz.html#cb59-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, </span>
<span id="cb59-2"><a href="dataviz.html#cb59-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> SBP, <span class="dt">y =</span> Pulse, </span>
<span id="cb59-3"><a href="dataviz.html#cb59-3"></a>           <span class="dt">color =</span> SleepTrouble, <span class="dt">shape =</span> SleepTrouble)) <span class="op">+</span></span>
<span id="cb59-4"><a href="dataviz.html#cb59-4"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb59-5"><a href="dataviz.html#cb59-5"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb59-6"><a href="dataviz.html#cb59-6"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;SBP vs. Pulse rate for NHANES subjects, ages 21-79&quot;</span>) <span class="op">+</span></span>
<span id="cb59-7"><a href="dataviz.html#cb59-7"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>SleepTrouble, <span class="dt">labeller =</span> <span class="st">&quot;label_both&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="431-notes_files/figure-html/nh_dat3_sbpvspulsewithsleepfacets-fig-1.png" width="672" /></p>
</div>
</div>
<div id="general-health-status" class="section level2">
<h2><span class="header-section-number">3.9</span> General Health Status</h2>
<p>Here’s a Table of the General Health Status results. Again, this is a self-reported rating of each subject’s health on a five point scale (Excellent, Very Good, Good, Fair, Poor.)</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="dataviz.html#cb61-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb61-2"><a href="dataviz.html#cb61-2"></a><span class="st">    </span><span class="kw">select</span>(HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb61-3"><a href="dataviz.html#cb61-3"></a><span class="st">    </span><span class="kw">table</span>()</span></code></pre></div>
<pre><code>.
Excellent     Vgood      Good      Fair      Poor 
       64       196       238        83        22 </code></pre>
<p>The HealthGen data are categorical, which means that summarizing them with averages isn’t as appealing as looking at percentages, proportions and rates.</p>
<p>Another, somewhat simpler way to get a table of this sort of information uses the <code>tabyl</code> function from the <code>janitor</code> package in R.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="dataviz.html#cb63-1"></a><span class="co"># tabyl is part of the janitor package</span></span>
<span id="cb63-2"><a href="dataviz.html#cb63-2"></a><span class="co"># already loaded: library(janitor)</span></span>
<span id="cb63-3"><a href="dataviz.html#cb63-3"></a></span>
<span id="cb63-4"><a href="dataviz.html#cb63-4"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb63-5"><a href="dataviz.html#cb63-5"></a><span class="st">    </span><span class="kw">tabyl</span>(HealthGen) </span></code></pre></div>
<pre><code> HealthGen   n    percent
 Excellent  64 0.10613599
     Vgood 196 0.32504146
      Good 238 0.39469320
      Fair  83 0.13764511
      Poor  22 0.03648425</code></pre>
<p>I don’t actually like the title of <code>percent</code> here, as it’s really a proportion, but that can be adjusted, and we can add a total.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="dataviz.html#cb65-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb65-2"><a href="dataviz.html#cb65-2"></a><span class="st">    </span><span class="kw">tabyl</span>(HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb65-3"><a href="dataviz.html#cb65-3"></a><span class="st">    </span><span class="kw">adorn_totals</span>() <span class="op">%&gt;%</span></span>
<span id="cb65-4"><a href="dataviz.html#cb65-4"></a><span class="st">    </span><span class="kw">adorn_pct_formatting</span>()</span></code></pre></div>
<pre><code> HealthGen   n percent
 Excellent  64   10.6%
     Vgood 196   32.5%
      Good 238   39.5%
      Fair  83   13.8%
      Poor  22    3.6%
     Total 603  100.0%</code></pre>
<p>When working with an unordered categorical variable, like <code>MaritalStatus</code>, the same approach can work.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="dataviz.html#cb67-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb67-2"><a href="dataviz.html#cb67-2"></a><span class="st">    </span><span class="kw">tabyl</span>(MaritalStatus) <span class="op">%&gt;%</span></span>
<span id="cb67-3"><a href="dataviz.html#cb67-3"></a><span class="st">    </span><span class="kw">adorn_totals</span>() <span class="op">%&gt;%</span></span>
<span id="cb67-4"><a href="dataviz.html#cb67-4"></a><span class="st">    </span><span class="kw">adorn_pct_formatting</span>()</span></code></pre></div>
<pre><code> MaritalStatus   n percent
      Divorced  61   10.1%
   LivePartner  43    7.1%
       Married 349   57.9%
  NeverMarried 104   17.2%
     Separated   8    1.3%
       Widowed  38    6.3%
         Total 603  100.0%</code></pre>
<div id="bar-chart-for-categorical-data" class="section level3">
<h3><span class="header-section-number">3.9.1</span> Bar Chart for Categorical Data</h3>
<p>Usually, a <strong>bar chart</strong> is the best choice for a graphing a variable made up of categories.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="dataviz.html#cb69-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> HealthGen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb69-2"><a href="dataviz.html#cb69-2"></a><span class="st">    </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="431-notes_files/figure-html/HealthGengraph1-fig-1.png" width="672" /></p>
<p>There are lots of things we can do to make this plot fancier.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="dataviz.html#cb70-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> HealthGen, <span class="dt">fill =</span> HealthGen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-2"><a href="dataviz.html#cb70-2"></a><span class="st">    </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-3"><a href="dataviz.html#cb70-3"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb70-4"><a href="dataviz.html#cb70-4"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Self-Reported Health Status&quot;</span>,</span>
<span id="cb70-5"><a href="dataviz.html#cb70-5"></a>         <span class="dt">y =</span> <span class="st">&quot;Number of NHANES subjects&quot;</span>,</span>
<span id="cb70-6"><a href="dataviz.html#cb70-6"></a>         <span class="dt">title =</span> <span class="st">&quot;Self-Reported Health Status in NHANES subjects ages 21-79&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/HealthGengraph2-fig-1.png" width="672" /></p>
<p>Or, we can really go crazy…</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="dataviz.html#cb71-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb71-2"><a href="dataviz.html#cb71-2"></a><span class="st">    </span><span class="kw">count</span>(HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb71-3"><a href="dataviz.html#cb71-3"></a><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb71-4"><a href="dataviz.html#cb71-4"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">pct =</span> <span class="kw">round</span>(<span class="kw">prop.table</span>(n) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb71-5"><a href="dataviz.html#cb71-5"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> HealthGen, <span class="dt">y =</span> pct, <span class="dt">fill =</span> HealthGen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb71-6"><a href="dataviz.html#cb71-6"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb71-7"><a href="dataviz.html#cb71-7"></a><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></span>
<span id="cb71-8"><a href="dataviz.html#cb71-8"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb71-9"><a href="dataviz.html#cb71-9"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pct <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,    <span class="co"># nudge above top of bar</span></span>
<span id="cb71-10"><a href="dataviz.html#cb71-10"></a>                  <span class="dt">label =</span> <span class="kw">paste0</span>(pct, <span class="st">&#39;%&#39;</span>)),  <span class="co"># prettify</span></span>
<span id="cb71-11"><a href="dataviz.html#cb71-11"></a>              <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.9</span>), </span>
<span id="cb71-12"><a href="dataviz.html#cb71-12"></a>              <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb71-13"><a href="dataviz.html#cb71-13"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Self-Reported Health Status&quot;</span>,</span>
<span id="cb71-14"><a href="dataviz.html#cb71-14"></a>         <span class="dt">y =</span> <span class="st">&quot;Percentage of NHANES subjects&quot;</span>,</span>
<span id="cb71-15"><a href="dataviz.html#cb71-15"></a>         <span class="dt">title =</span> <span class="st">&quot;Self-Reported Health Status in NHANES subjects ages 21-79&quot;</span>) <span class="op">+</span></span>
<span id="cb71-16"><a href="dataviz.html#cb71-16"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="431-notes_files/figure-html/HealthGengraph3-fig-1.png" width="672" /></p>
</div>
<div id="working-with-tables" class="section level3">
<h3><span class="header-section-number">3.9.2</span> Working with Tables</h3>
<p>We can add both row and column marginal totals, and compare subjects by Sex, as follows…</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="dataviz.html#cb72-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb72-2"><a href="dataviz.html#cb72-2"></a><span class="st">    </span><span class="kw">tabyl</span>(Sex, HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb72-3"><a href="dataviz.html#cb72-3"></a><span class="st">    </span><span class="kw">adorn_totals</span>(<span class="kw">c</span>(<span class="st">&quot;row&quot;</span>, <span class="st">&quot;col&quot;</span>)) </span></code></pre></div>
<pre><code>    Sex Excellent Vgood Good Fair Poor Total
 female        27    96  121   41   14   299
   male        37   100  117   42    8   304
  Total        64   196  238   83   22   603</code></pre>
<p>If we like, we can make this look a little more polished with the <code>knitr::kable</code> function…</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="dataviz.html#cb74-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb74-2"><a href="dataviz.html#cb74-2"></a><span class="st">    </span><span class="kw">tabyl</span>(Sex, HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb74-3"><a href="dataviz.html#cb74-3"></a><span class="st">    </span><span class="kw">adorn_totals</span>(<span class="kw">c</span>(<span class="st">&quot;row&quot;</span>, <span class="st">&quot;col&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb74-4"><a href="dataviz.html#cb74-4"></a><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Sex</th>
<th align="right">Excellent</th>
<th align="right">Vgood</th>
<th align="right">Good</th>
<th align="right">Fair</th>
<th align="right">Poor</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">female</td>
<td align="right">27</td>
<td align="right">96</td>
<td align="right">121</td>
<td align="right">41</td>
<td align="right">14</td>
<td align="right">299</td>
</tr>
<tr class="even">
<td align="left">male</td>
<td align="right">37</td>
<td align="right">100</td>
<td align="right">117</td>
<td align="right">42</td>
<td align="right">8</td>
<td align="right">304</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">64</td>
<td align="right">196</td>
<td align="right">238</td>
<td align="right">83</td>
<td align="right">22</td>
<td align="right">603</td>
</tr>
</tbody>
</table>
<p>Or, we can get a complete cross-tabulation, including (in this case) the percentages of people within each Sex that fall in each HealthGen category (percentages within each row) like this.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="dataviz.html#cb75-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb75-2"><a href="dataviz.html#cb75-2"></a><span class="st">    </span><span class="kw">tabyl</span>(Sex, HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb75-3"><a href="dataviz.html#cb75-3"></a><span class="st">    </span><span class="kw">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb75-4"><a href="dataviz.html#cb75-4"></a><span class="st">    </span><span class="kw">adorn_percentages</span>(<span class="st">&quot;row&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb75-5"><a href="dataviz.html#cb75-5"></a><span class="st">    </span><span class="kw">adorn_pct_formatting</span>() <span class="op">%&gt;%</span></span>
<span id="cb75-6"><a href="dataviz.html#cb75-6"></a><span class="st">    </span><span class="kw">adorn_ns</span>() <span class="op">%&gt;%</span></span>
<span id="cb75-7"><a href="dataviz.html#cb75-7"></a><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Sex</th>
<th align="left">Excellent</th>
<th align="left">Vgood</th>
<th align="left">Good</th>
<th align="left">Fair</th>
<th align="left">Poor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">female</td>
<td align="left">9.0% (27)</td>
<td align="left">32.1% (96)</td>
<td align="left">40.5% (121)</td>
<td align="left">13.7% (41)</td>
<td align="left">4.7% (14)</td>
</tr>
<tr class="even">
<td align="left">male</td>
<td align="left">12.2% (37)</td>
<td align="left">32.9% (100)</td>
<td align="left">38.5% (117)</td>
<td align="left">13.8% (42)</td>
<td align="left">2.6% (8)</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="left">10.6% (64)</td>
<td align="left">32.5% (196)</td>
<td align="left">39.5% (238)</td>
<td align="left">13.8% (83)</td>
<td align="left">3.6% (22)</td>
</tr>
</tbody>
</table>
<p>And, if we wanted the column percentages, to determine which sex had the higher rate of each HealthGen status level, we can get that by changing the adorn_percentages to describe results at the column level:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="dataviz.html#cb76-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb76-2"><a href="dataviz.html#cb76-2"></a><span class="st">    </span><span class="kw">tabyl</span>(Sex, HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb76-3"><a href="dataviz.html#cb76-3"></a><span class="st">    </span><span class="kw">adorn_totals</span>(<span class="st">&quot;col&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb76-4"><a href="dataviz.html#cb76-4"></a><span class="st">    </span><span class="kw">adorn_percentages</span>(<span class="st">&quot;col&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb76-5"><a href="dataviz.html#cb76-5"></a><span class="st">    </span><span class="kw">adorn_pct_formatting</span>() <span class="op">%&gt;%</span></span>
<span id="cb76-6"><a href="dataviz.html#cb76-6"></a><span class="st">    </span><span class="kw">adorn_ns</span>() <span class="op">%&gt;%</span></span>
<span id="cb76-7"><a href="dataviz.html#cb76-7"></a><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Sex</th>
<th align="left">Excellent</th>
<th align="left">Vgood</th>
<th align="left">Good</th>
<th align="left">Fair</th>
<th align="left">Poor</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">female</td>
<td align="left">42.2% (27)</td>
<td align="left">49.0% (96)</td>
<td align="left">50.8% (121)</td>
<td align="left">49.4% (41)</td>
<td align="left">63.6% (14)</td>
<td align="left">49.6% (299)</td>
</tr>
<tr class="even">
<td align="left">male</td>
<td align="left">57.8% (37)</td>
<td align="left">51.0% (100)</td>
<td align="left">49.2% (117)</td>
<td align="left">50.6% (42)</td>
<td align="left">36.4% (8)</td>
<td align="left">50.4% (304)</td>
</tr>
</tbody>
</table>
</div>
<div id="sbp-by-general-health-status" class="section level3">
<h3><span class="header-section-number">3.9.3</span> SBP by General Health Status</h3>
<p>Let’s consider now the relationship between self-reported overall health and systolic blood pressure.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="dataviz.html#cb77-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> HealthGen, <span class="dt">y =</span> SBP, <span class="dt">fill =</span> HealthGen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-2"><a href="dataviz.html#cb77-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-3"><a href="dataviz.html#cb77-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;SBP by Health Status, Overall Health for NHANES ages 21-79&quot;</span>,</span>
<span id="cb77-4"><a href="dataviz.html#cb77-4"></a>         <span class="dt">y =</span> <span class="st">&quot;Systolic Blood Pressure&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Self-Reported Overall Health&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-5"><a href="dataviz.html#cb77-5"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) </span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_sbpbyhealth-fig-1.png" width="672" /></p>
<p>We can see that not too many people self-identify with the “Poor” health category.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="dataviz.html#cb78-1"></a>nh_dat3 <span class="op">%&gt;%</span></span>
<span id="cb78-2"><a href="dataviz.html#cb78-2"></a><span class="st">    </span><span class="kw">group_by</span>(HealthGen) <span class="op">%&gt;%</span></span>
<span id="cb78-3"><a href="dataviz.html#cb78-3"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(), <span class="kw">mean</span>(SBP), <span class="kw">median</span>(SBP)) <span class="op">%&gt;%</span></span>
<span id="cb78-4"><a href="dataviz.html#cb78-4"></a><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>() </span></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">HealthGen</th>
<th align="right">count</th>
<th align="right">mean(SBP)</th>
<th align="right">median(SBP)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Excellent</td>
<td align="right">64</td>
<td align="right">119.1562</td>
<td align="right">117.0</td>
</tr>
<tr class="even">
<td align="left">Vgood</td>
<td align="right">196</td>
<td align="right">119.0714</td>
<td align="right">118.0</td>
</tr>
<tr class="odd">
<td align="left">Good</td>
<td align="right">238</td>
<td align="right">120.4244</td>
<td align="right">119.5</td>
</tr>
<tr class="even">
<td align="left">Fair</td>
<td align="right">83</td>
<td align="right">123.9398</td>
<td align="right">119.0</td>
</tr>
<tr class="odd">
<td align="left">Poor</td>
<td align="right">22</td>
<td align="right">125.8636</td>
<td align="right">126.5</td>
</tr>
</tbody>
</table>
</div>
<div id="sbp-by-physical-activity-and-general-health-status" class="section level3">
<h3><span class="header-section-number">3.9.4</span> SBP by Physical Activity and General Health Status</h3>
<p>We’ll build a panel of boxplots to try to understand the relationships between Systolic Blood Pressure, General Health Status and Physical Activity. Note the use of <code>coord_flip</code> to rotate the graph 90 degrees, and the use of <code>labeller</code> within <code>facet_wrap</code> to include both the name of the (Physical Activity) variable and its value.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="dataviz.html#cb80-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> HealthGen, <span class="dt">y =</span> SBP, <span class="dt">fill =</span> HealthGen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-2"><a href="dataviz.html#cb80-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-3"><a href="dataviz.html#cb80-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;SBP by Health Status, Overall Health for NHANES ages 21-79&quot;</span>,</span>
<span id="cb80-4"><a href="dataviz.html#cb80-4"></a>         <span class="dt">y =</span> <span class="st">&quot;Body-mass index&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Self-Reported Overall Health&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-5"><a href="dataviz.html#cb80-5"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb80-6"><a href="dataviz.html#cb80-6"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>PhysActive, <span class="dt">labeller =</span> <span class="st">&quot;label_both&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-7"><a href="dataviz.html#cb80-7"></a><span class="st">    </span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_bmibyhealthbysex1-fig-1.png" width="672" /></p>
</div>
<div id="sbp-by-sleep-trouble-and-general-health-status" class="section level3">
<h3><span class="header-section-number">3.9.5</span> SBP by Sleep Trouble and General Health Status</h3>
<p>Here’s a plot of faceted histograms, which might be used to address similar questions related to the relationship between Overall Health, Systolic Blood Pressure and Sex.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="dataviz.html#cb81-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> nh_dat3, <span class="kw">aes</span>(<span class="dt">x =</span> SBP, <span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-2"><a href="dataviz.html#cb81-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-3"><a href="dataviz.html#cb81-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;SBP by Sex, Overall Health for NHANES ages 21-79&quot;</span>,</span>
<span id="cb81-4"><a href="dataviz.html#cb81-4"></a>         <span class="dt">x =</span> <span class="st">&quot;Body-mass index&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-5"><a href="dataviz.html#cb81-5"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb81-6"><a href="dataviz.html#cb81-6"></a><span class="st">    </span><span class="kw">facet_grid</span>(HealthGen <span class="op">~</span><span class="st"> </span>Sex)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/nh_dat3_bmibyhealthbysex2-fig-1.png" width="672" /></p>
</div>
</div>
<div id="conclusions" class="section level2">
<h2><span class="header-section-number">3.10</span> Conclusions</h2>
<p>This is just a small piece of the toolbox for visualizations that we’ll create in this class. Many additional tools are on the way, but the main idea won’t change. Using the <code>ggplot2</code> package, we can accomplish several critical tasks in creating a visualization, including:</p>
<ul>
<li>Identifying (and labeling) the axes and titles</li>
<li>Identifying a type of <code>geom</code> to use, like a point, bar or histogram</li>
<li>Changing fill, color, shape, size to facilitate comparisons</li>
<li>Building “small multiples” of plots with faceting</li>
</ul>
<p>Good data visualizations make it easy to see the data, and <code>ggplot2</code>’s tools make it relatively difficult to make a really bad graph.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-BaumerKaplanHorton">
<p>Baumer, Benjamin S., Daniel T. Kaplan, and Nicholas J. Horton. 2017. <em>Modern Data Science with R</em>. Boca Raton, FL: CRC Press. <a href="https://mdsr-book.github.io/">https://mdsr-book.github.io/</a>.</p>
</div>
<div id="ref-R4DS">
<p>Grolemund, Garrett, and Hadley Wickham. 2019. <em>R for Data Science</em>. O’Reilly. <a href="http://r4ds.had.co.nz/">http://r4ds.had.co.nz/</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>For more on the NHANES data available in the NHANES package, type ?NHANES in the Console in R Studio.<a href="dataviz.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>If you visit the NHANES help file with ?NHANES, you will see that subjects 80 years or older were indeed recorded as 80.<a href="dataviz.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="looking-at-the-palmer-penguins.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-structures-and-types-of-variables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-nhanes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["431-notes.pdf", "431-notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
