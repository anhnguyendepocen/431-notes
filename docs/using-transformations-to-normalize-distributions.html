<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Using Transformations to “Normalize” Distributions | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</title>
  <meta name="description" content="This book describes some fundamental approaches to doing biostatistical and data science in research." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Using Transformations to “Normalize” Distributions | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book describes some fundamental approaches to doing biostatistical and data science in research." />
  <meta name="github-repo" content="thomaselove/431-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Using Transformations to “Normalize” Distributions | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431" />
  
  <meta name="twitter:description" content="This book describes some fundamental approaches to doing biostatistical and data science in research." />
  

<meta name="author" content="Thomas E. Love" />


<meta name="date" content="2020-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="assessing-normality.html"/>
<link rel="next" href="summarizing-data-within-subgroups.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dr. Love's Notes for 431</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Working with These Notes</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-431-course-online"><i class="fa fa-check"></i>The 431 Course online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-youll-find-here"><i class="fa fa-check"></i>What You’ll Find Here</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#setting-up-r"><i class="fa fa-check"></i>Setting Up R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#initial-setup-of-r-packages"><i class="fa fa-check"></i>Initial Setup of R Packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#additional-r-packages-installed-for-this-book"><i class="fa fa-check"></i>Additional R Packages installed for this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>1</b> Data Science</a><ul>
<li class="chapter" data-level="1.1" data-path="data-science.html"><a href="data-science.html#data-science-project-cycle"><i class="fa fa-check"></i><b>1.1</b> Data Science Project Cycle</a></li>
<li class="chapter" data-level="1.2" data-path="data-science.html"><a href="data-science.html#data-science-and-the-431-course"><i class="fa fa-check"></i><b>1.2</b> Data Science and the 431 Course</a></li>
<li class="chapter" data-level="1.3" data-path="data-science.html"><a href="data-science.html#what-the-course-is-and-isnt"><i class="fa fa-check"></i><b>1.3</b> What The Course Is and Isn’t</a></li>
</ul></li>
<li class="part"><span><b>Part A. Exploring Data</b></span></li>
<li class="chapter" data-level="2" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html"><i class="fa fa-check"></i><b>2</b> Looking at the Palmer Penguins</a><ul>
<li class="chapter" data-level="2.1" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#package-loading-then-dealing-with-missing-data"><i class="fa fa-check"></i><b>2.1</b> Package Loading, then Dealing with Missing Data</a></li>
<li class="chapter" data-level="2.2" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#counting-things-and-making-tables"><i class="fa fa-check"></i><b>2.2</b> Counting Things and Making Tables</a></li>
<li class="chapter" data-level="2.3" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#visualizing-the-data-in-a-graph-or-a-few"><i class="fa fa-check"></i><b>2.3</b> Visualizing the Data in a Graph (or a few…)</a></li>
<li class="chapter" data-level="2.4" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#six-ways-to-improve-this-graph"><i class="fa fa-check"></i><b>2.4</b> Six Ways To “Improve” This Graph</a></li>
<li class="chapter" data-level="2.5" data-path="looking-at-the-palmer-penguins.html"><a href="looking-at-the-palmer-penguins.html#a-little-reflection"><i class="fa fa-check"></i><b>2.5</b> A Little Reflection</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> NHANES: Initial Exploring</a><ul>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#the-nhanes-data-collecting-a-sample"><i class="fa fa-check"></i><b>3.1</b> The NHANES data: Collecting a Sample</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#age-and-height"><i class="fa fa-check"></i><b>3.2</b> Age and Height</a></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#subset-of-subjects-with-known-age-and-height"><i class="fa fa-check"></i><b>3.3</b> Subset of Subjects with Known Age and Height</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#the-distinction-between-gender-and-sex"><i class="fa fa-check"></i><b>3.3.1</b> The Distinction between <code>Gender</code> and <code>Sex</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#age-height-and-sex"><i class="fa fa-check"></i><b>3.4</b> Age-Height and Sex?</a><ul>
<li class="chapter" data-level="3.4.1" data-path="dataviz.html"><a href="dataviz.html#can-we-show-the-female-and-male-relationships-in-separate-panels"><i class="fa fa-check"></i><b>3.4.1</b> Can we show the Female and Male relationships in separate panels?</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataviz.html"><a href="dataviz.html#can-we-add-a-smooth-curve-to-show-the-relationship-in-each-plot"><i class="fa fa-check"></i><b>3.4.2</b> Can we add a smooth curve to show the relationship in each plot?</a></li>
<li class="chapter" data-level="3.4.3" data-path="dataviz.html"><a href="dataviz.html#what-if-we-want-to-assume-straight-line-relationships"><i class="fa fa-check"></i><b>3.4.3</b> What if we want to assume straight line relationships?</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataviz.html"><a href="dataviz.html#creating-a-new-subset-ages-21-79"><i class="fa fa-check"></i><b>3.5</b> Creating A New Subset: Ages 21-79</a></li>
<li class="chapter" data-level="3.6" data-path="dataviz.html"><a href="dataviz.html#distribution-of-heights"><i class="fa fa-check"></i><b>3.6</b> Distribution of Heights</a><ul>
<li class="chapter" data-level="3.6.1" data-path="dataviz.html"><a href="dataviz.html#changing-a-histograms-fill-and-color"><i class="fa fa-check"></i><b>3.6.1</b> Changing a Histogram’s Fill and Color</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dataviz.html"><a href="dataviz.html#height-and-sex"><i class="fa fa-check"></i><b>3.7</b> Height and Sex</a><ul>
<li class="chapter" data-level="3.7.1" data-path="dataviz.html"><a href="dataviz.html#a-boxplot-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.1</b> A Boxplot of Height by Sex</a></li>
<li class="chapter" data-level="3.7.2" data-path="dataviz.html"><a href="dataviz.html#histograms-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.2</b> Histograms of Height by Sex</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="dataviz.html"><a href="dataviz.html#looking-at-pulse-rate"><i class="fa fa-check"></i><b>3.8</b> Looking at Pulse Rate</a><ul>
<li class="chapter" data-level="3.8.1" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-physical-activity"><i class="fa fa-check"></i><b>3.8.1</b> Pulse Rate and Physical Activity</a></li>
<li class="chapter" data-level="3.8.2" data-path="dataviz.html"><a href="dataviz.html#pulse-by-sleeping-trouble"><i class="fa fa-check"></i><b>3.8.2</b> Pulse by Sleeping Trouble</a></li>
<li class="chapter" data-level="3.8.3" data-path="dataviz.html"><a href="dataviz.html#pulse-and-healthgen"><i class="fa fa-check"></i><b>3.8.3</b> Pulse and HealthGen</a></li>
<li class="chapter" data-level="3.8.4" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-systolic-blood-pressure"><i class="fa fa-check"></i><b>3.8.4</b> Pulse Rate and Systolic Blood Pressure</a></li>
<li class="chapter" data-level="3.8.5" data-path="dataviz.html"><a href="dataviz.html#sleep-trouble-vs.-no-sleep-trouble"><i class="fa fa-check"></i><b>3.8.5</b> Sleep Trouble vs. No Sleep Trouble?</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="dataviz.html"><a href="dataviz.html#general-health-status"><i class="fa fa-check"></i><b>3.9</b> General Health Status</a><ul>
<li class="chapter" data-level="3.9.1" data-path="dataviz.html"><a href="dataviz.html#bar-chart-for-categorical-data"><i class="fa fa-check"></i><b>3.9.1</b> Bar Chart for Categorical Data</a></li>
<li class="chapter" data-level="3.9.2" data-path="dataviz.html"><a href="dataviz.html#working-with-tables"><i class="fa fa-check"></i><b>3.9.2</b> Working with Tables</a></li>
<li class="chapter" data-level="3.9.3" data-path="dataviz.html"><a href="dataviz.html#sbp-by-general-health-status"><i class="fa fa-check"></i><b>3.9.3</b> SBP by General Health Status</a></li>
<li class="chapter" data-level="3.9.4" data-path="dataviz.html"><a href="dataviz.html#sbp-by-physical-activity-and-general-health-status"><i class="fa fa-check"></i><b>3.9.4</b> SBP by Physical Activity and General Health Status</a></li>
<li class="chapter" data-level="3.9.5" data-path="dataviz.html"><a href="dataviz.html#sbp-by-sleep-trouble-and-general-health-status"><i class="fa fa-check"></i><b>3.9.5</b> SBP by Sleep Trouble and General Health Status</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="dataviz.html"><a href="dataviz.html#conclusions"><i class="fa fa-check"></i><b>3.10</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html"><i class="fa fa-check"></i><b>4</b> Data Structures and Types of Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#data-require-structure-and-context"><i class="fa fa-check"></i><b>4.1</b> Data require structure and context</a></li>
<li class="chapter" data-level="4.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#newNHANES"><i class="fa fa-check"></i><b>4.2</b> A New NHANES Adult Sample</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#summarizing-the-datas-structure"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing the Data’s Structure</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#what-are-the-variables"><i class="fa fa-check"></i><b>4.2.2</b> What are the variables?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#quantitative-variables"><i class="fa fa-check"></i><b>4.3</b> Quantitative Variables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#a-look-at-bmi-body-mass-index"><i class="fa fa-check"></i><b>4.3.1</b> A look at BMI (Body-Mass Index)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#qualitative-categorical-variables"><i class="fa fa-check"></i><b>4.4</b> Qualitative (Categorical) Variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html"><i class="fa fa-check"></i><b>5</b> Summarizing Quantitative Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-summary-function-for-quantitative-data"><i class="fa fa-check"></i><b>5.1</b> The <code>summary</code> function for Quantitative data</a></li>
<li class="chapter" data-level="5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-center-of-a-distribution"><i class="fa fa-check"></i><b>5.2</b> Measuring the Center of a Distribution</a><ul>
<li class="chapter" data-level="5.2.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mean-and-the-median"><i class="fa fa-check"></i><b>5.2.1</b> The Mean and The Median</a></li>
<li class="chapter" data-level="5.2.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#dealing-with-missingness"><i class="fa fa-check"></i><b>5.2.2</b> Dealing with Missingness</a></li>
<li class="chapter" data-level="5.2.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mode-of-a-quantitative-variable"><i class="fa fa-check"></i><b>5.2.3</b> The Mode of a Quantitative Variable</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-spread-of-a-distribution"><i class="fa fa-check"></i><b>5.3</b> Measuring the Spread of a Distribution</a><ul>
<li class="chapter" data-level="5.3.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#rangeandiqr"><i class="fa fa-check"></i><b>5.3.1</b> The Range and the Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="5.3.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-variance-and-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.2</b> The Variance and the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#obtaining-the-variance-and-standard-deviation-in-r"><i class="fa fa-check"></i><b>5.3.3</b> Obtaining the Variance and Standard Deviation in R</a></li>
<li class="chapter" data-level="5.3.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#defining-the-variance-and-standard-deviation"><i class="fa fa-check"></i><b>5.3.4</b> Defining the Variance and Standard Deviation</a></li>
<li class="chapter" data-level="5.3.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#interpreting-the-sd-when-the-data-are-normally-distributed"><i class="fa fa-check"></i><b>5.3.5</b> Interpreting the SD when the data are Normally distributed</a></li>
<li class="chapter" data-level="5.3.6" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#chebyshevs-inequality-one-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.6</b> Chebyshev’s Inequality: One Interpretation of the Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-shape-of-a-distribution"><i class="fa fa-check"></i><b>5.4</b> Measuring the Shape of a Distribution</a><ul>
<li class="chapter" data-level="5.4.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#multimodal-vs.-unimodal-distributions"><i class="fa fa-check"></i><b>5.4.1</b> Multimodal vs. Unimodal distributions</a></li>
<li class="chapter" data-level="5.4.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#skew"><i class="fa fa-check"></i><b>5.4.2</b> Skew</a></li>
<li class="chapter" data-level="5.4.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#kurtosis"><i class="fa fa-check"></i><b>5.4.3</b> Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#more-detailed-numerical-summaries-for-quantitative-variables"><i class="fa fa-check"></i><b>5.5</b> More Detailed Numerical Summaries for Quantitative Variables</a><ul>
<li class="chapter" data-level="5.5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#favstats-in-the-mosaic-package"><i class="fa fa-check"></i><b>5.5.1</b> <code>favstats</code> in the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="5.5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-psych-package"><i class="fa fa-check"></i><b>5.5.2</b> <code>describe</code> in the <code>psych</code> package</a></li>
<li class="chapter" data-level="5.5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-hmisc-packages-version-of-describe"><i class="fa fa-check"></i><b>5.5.3</b> The <code>Hmisc</code> package’s version of <code>describe</code></a></li>
<li class="chapter" data-level="5.5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#other-options"><i class="fa fa-check"></i><b>5.5.4</b> Other options</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html"><i class="fa fa-check"></i><b>6</b> Summarizing Categorical Variables</a><ul>
<li class="chapter" data-level="6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-summary-function-for-categorical-data"><i class="fa fa-check"></i><b>6.1</b> The <code>summary</code> function for Categorical data</a></li>
<li class="chapter" data-level="6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#tables-to-describe-one-categorical-variable"><i class="fa fa-check"></i><b>6.2</b> Tables to describe One Categorical Variable</a></li>
<li class="chapter" data-level="6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-mode-of-a-categorical-variable"><i class="fa fa-check"></i><b>6.3</b> The Mode of a Categorical Variable</a></li>
<li class="chapter" data-level="6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#describe-in-the-hmisc-package"><i class="fa fa-check"></i><b>6.4</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="6.5" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-tabulations"><i class="fa fa-check"></i><b>6.5</b> Cross-Tabulations</a><ul>
<li class="chapter" data-level="6.5.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-classifying-three-categorical-variables"><i class="fa fa-check"></i><b>6.5.1</b> Cross-Classifying Three Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#constructing-tables-well"><i class="fa fa-check"></i><b>6.6</b> Constructing Tables Well</a><ul>
<li class="chapter" data-level="6.6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#alabama-first"><i class="fa fa-check"></i><b>6.6.1</b> Alabama First!</a></li>
<li class="chapter" data-level="6.6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#order-rows-and-columns-sensibly"><i class="fa fa-check"></i><b>6.6.2</b> Order rows and columns sensibly</a></li>
<li class="chapter" data-level="6.6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#round---a-lot"><i class="fa fa-check"></i><b>6.6.3</b> Round - a lot!</a></li>
<li class="chapter" data-level="6.6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#all-is-different-and-important"><i class="fa fa-check"></i><b>6.6.4</b> ALL is different and important</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#gaining-control-over-tables-in-r-the-gt-package"><i class="fa fa-check"></i><b>6.7</b> Gaining Control over Tables in R: the <code>gt</code> package</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="NYFS-Study.html"><a href="NYFS-Study.html"><i class="fa fa-check"></i><b>7</b> NHANES National Youth Fitness Survey (<code>nnyfs</code>)</a><ul>
<li class="chapter" data-level="7.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-variables-included-in-nnyfs"><i class="fa fa-check"></i><b>7.1</b> The Variables included in <code>nnyfs</code></a><ul>
<li class="chapter" data-level="7.1.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-demographic-component"><i class="fa fa-check"></i><b>7.1.1</b> From the <span>NNYFS Demographic Component</span></a></li>
<li class="chapter" data-level="7.1.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-dietary-component"><i class="fa fa-check"></i><b>7.1.2</b> From the <span>NNYFS Dietary Component</span></a></li>
<li class="chapter" data-level="7.1.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-examination-component"><i class="fa fa-check"></i><b>7.1.3</b> From the <span>NNYFS Examination Component</span></a></li>
<li class="chapter" data-level="7.1.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-questionnaire-component"><i class="fa fa-check"></i><b>7.1.4</b> From the <span>NNYFS Questionnaire Component</span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#looking-over-a-few-variables"><i class="fa fa-check"></i><b>7.2</b> Looking over A Few Variables</a><ul>
<li class="chapter" data-level="7.2.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#seqn"><i class="fa fa-check"></i><b>7.2.1</b> <code>SEQN</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#sex"><i class="fa fa-check"></i><b>7.2.2</b> <code>sex</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#age_child"><i class="fa fa-check"></i><b>7.2.3</b> <code>age_child</code></a></li>
<li class="chapter" data-level="7.2.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#race_eth"><i class="fa fa-check"></i><b>7.2.4</b> <code>race_eth</code></a></li>
<li class="chapter" data-level="7.2.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#income_pov"><i class="fa fa-check"></i><b>7.2.5</b> <code>income_pov</code></a></li>
<li class="chapter" data-level="7.2.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi"><i class="fa fa-check"></i><b>7.2.6</b> <code>bmi</code></a></li>
<li class="chapter" data-level="7.2.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi_cat"><i class="fa fa-check"></i><b>7.2.7</b> <code>bmi_cat</code></a></li>
<li class="chapter" data-level="7.2.8" data-path="NYFS-Study.html"><a href="NYFS-Study.html#waist"><i class="fa fa-check"></i><b>7.2.8</b> <code>waist</code></a></li>
<li class="chapter" data-level="7.2.9" data-path="NYFS-Study.html"><a href="NYFS-Study.html#triceps_skinfold"><i class="fa fa-check"></i><b>7.2.9</b> <code>triceps_skinfold</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#additional-numeric-summaries"><i class="fa fa-check"></i><b>7.3</b> Additional Numeric Summaries</a><ul>
<li class="chapter" data-level="7.3.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-five-number-summary-quantiles-and-iqr"><i class="fa fa-check"></i><b>7.3.1</b> The Five Number Summary, Quantiles and IQR</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#additional-summaries-from-favstats"><i class="fa fa-check"></i><b>7.4</b> Additional Summaries from <code>favstats</code></a></li>
<li class="chapter" data-level="7.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-histogram"><i class="fa fa-check"></i><b>7.5</b> The Histogram</a><ul>
<li class="chapter" data-level="7.5.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#freedman-diaconis-rule-to-select-bin-width"><i class="fa fa-check"></i><b>7.5.1</b> Freedman-Diaconis Rule to select bin width</a></li>
<li class="chapter" data-level="7.5.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-note-on-colors"><i class="fa fa-check"></i><b>7.5.2</b> A Note on Colors</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-dot-plot-to-display-a-distribution"><i class="fa fa-check"></i><b>7.6</b> The Dot Plot to display a distribution</a></li>
<li class="chapter" data-level="7.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-frequency-polygon"><i class="fa fa-check"></i><b>7.7</b> The Frequency Polygon</a></li>
<li class="chapter" data-level="7.8" data-path="NYFS-Study.html"><a href="NYFS-Study.html#plotting-the-probability-density-function"><i class="fa fa-check"></i><b>7.8</b> Plotting the Probability Density Function</a></li>
<li class="chapter" data-level="7.9" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-boxplot"><i class="fa fa-check"></i><b>7.9</b> The Boxplot</a><ul>
<li class="chapter" data-level="7.9.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#drawing-a-boxplot-for-one-variable-in-ggplot2"><i class="fa fa-check"></i><b>7.9.1</b> Drawing a Boxplot for One Variable in <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.9.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#about-the-boxplot"><i class="fa fa-check"></i><b>7.9.2</b> About the Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-simple-comparison-boxplot"><i class="fa fa-check"></i><b>7.10</b> A Simple Comparison Boxplot</a></li>
<li class="chapter" data-level="7.11" data-path="NYFS-Study.html"><a href="NYFS-Study.html#using-describe-in-the-psych-library"><i class="fa fa-check"></i><b>7.11</b> Using <code>describe</code> in the <code>psych</code> library</a><ul>
<li class="chapter" data-level="7.11.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-trimmed-mean"><i class="fa fa-check"></i><b>7.11.1</b> The Trimmed Mean</a></li>
<li class="chapter" data-level="7.11.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-median-absolute-deviation"><i class="fa fa-check"></i><b>7.11.2</b> The Median Absolute Deviation</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-skew"><i class="fa fa-check"></i><b>7.12</b> Assessing Skew</a><ul>
<li class="chapter" data-level="7.12.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#non-parametric-skewness"><i class="fa fa-check"></i><b>7.12.1</b> Non-parametric Skewness</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-kurtosis-heavy-tailedness"><i class="fa fa-check"></i><b>7.13</b> Assessing Kurtosis (Heavy-Tailedness)</a><ul>
<li class="chapter" data-level="7.13.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-standard-error-of-the-sample-mean"><i class="fa fa-check"></i><b>7.13.1</b> The Standard Error of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-describe-function-in-the-hmisc-package"><i class="fa fa-check"></i><b>7.14</b> The <code>describe</code> function in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="7.15" data-path="NYFS-Study.html"><a href="NYFS-Study.html#what-summaries-to-report"><i class="fa fa-check"></i><b>7.15</b> What Summaries to Report</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="assessing-normality.html"><a href="assessing-normality.html"><i class="fa fa-check"></i><b>8</b> Assessing Normality</a><ul>
<li class="chapter" data-level="8.1" data-path="assessing-normality.html"><a href="assessing-normality.html#empirical-rule-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>8.1</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="8.2" data-path="assessing-normality.html"><a href="assessing-normality.html#describing-outlying-values-with-z-scores"><i class="fa fa-check"></i><b>8.2</b> Describing Outlying Values with Z Scores</a><ul>
<li class="chapter" data-level="8.2.1" data-path="assessing-normality.html"><a href="assessing-normality.html#fences-and-z-scores"><i class="fa fa-check"></i><b>8.2.1</b> Fences and Z Scores</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="assessing-normality.html"><a href="assessing-normality.html#comparing-a-histogram-to-a-normal-distribution"><i class="fa fa-check"></i><b>8.3</b> Comparing a Histogram to a Normal Distribution</a><ul>
<li class="chapter" data-level="8.3.1" data-path="assessing-normality.html"><a href="assessing-normality.html#histogram-of-energy-with-normal-model-with-counts"><i class="fa fa-check"></i><b>8.3.1</b> Histogram of <code>energy</code> with Normal model (with Counts)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="assessing-normality.html"><a href="assessing-normality.html#does-a-normal-model-work-well-for-the-waist-circumference"><i class="fa fa-check"></i><b>8.4</b> Does a Normal model work well for the <code>waist</code> circumference?</a></li>
<li class="chapter" data-level="8.5" data-path="assessing-normality.html"><a href="assessing-normality.html#the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.5</b> The Normal Q-Q Plot</a></li>
<li class="chapter" data-level="8.6" data-path="assessing-normality.html"><a href="assessing-normality.html#interpreting-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6</b> Interpreting the Normal Q-Q Plot</a><ul>
<li class="chapter" data-level="8.6.1" data-path="assessing-normality.html"><a href="assessing-normality.html#data-from-a-normal-distribution-shows-up-as-a-straight-line-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.1</b> Data from a Normal distribution shows up as a straight line in a Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.2" data-path="assessing-normality.html"><a href="assessing-normality.html#skew-is-indicated-by-monotonic-curves-in-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.2</b> Skew is indicated by monotonic curves in the Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.3" data-path="assessing-normality.html"><a href="assessing-normality.html#direction-of-skew"><i class="fa fa-check"></i><b>8.6.3</b> Direction of Skew</a></li>
<li class="chapter" data-level="8.6.4" data-path="assessing-normality.html"><a href="assessing-normality.html#outlier-proneness-is-indicated-by-s-shaped-curves-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.4</b> Outlier-proneness is indicated by “s-shaped” curves in a Normal Q-Q plot</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="assessing-normality.html"><a href="assessing-normality.html#can-a-normal-distribution-fit-the-nnyfs-energy-data-well"><i class="fa fa-check"></i><b>8.7</b> Can a Normal Distribution Fit the <code>nnyfs</code> <code>energy</code> data Well?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html"><i class="fa fa-check"></i><b>9</b> Using Transformations to “Normalize” Distributions</a><ul>
<li class="chapter" data-level="9.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-ladder-of-power-transformations"><i class="fa fa-check"></i><b>9.1</b> The Ladder of Power Transformations</a></li>
<li class="chapter" data-level="9.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-the-ladder"><i class="fa fa-check"></i><b>9.2</b> Using the Ladder</a></li>
<li class="chapter" data-level="9.3" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#protein-consumption-in-the-nnyfs-data"><i class="fa fa-check"></i><b>9.3</b> Protein Consumption in the NNYFS data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-patchwork-to-compose-plots"><i class="fa fa-check"></i><b>9.3.1</b> Using <code>patchwork</code> to compose plots</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#can-we-transform-the-protein-data"><i class="fa fa-check"></i><b>9.4</b> Can we transform the <code>protein</code> data?</a><ul>
<li class="chapter" data-level="9.4.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-square-root"><i class="fa fa-check"></i><b>9.4.1</b> The Square Root</a></li>
<li class="chapter" data-level="9.4.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-logarithm"><i class="fa fa-check"></i><b>9.4.2</b> The Logarithm</a></li>
<li class="chapter" data-level="9.4.3" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#this-course-uses-natural-logarithms-unless-otherwise-specified"><i class="fa fa-check"></i><b>9.4.3</b> This course uses Natural Logarithms, unless otherwise specified</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#what-if-we-considered-all-9-available-transformations"><i class="fa fa-check"></i><b>9.5</b> What if we considered all 9 available transformations?</a></li>
<li class="chapter" data-level="9.6" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#a-simulated-data-set"><i class="fa fa-check"></i><b>9.6</b> A Simulated Data Set</a></li>
<li class="chapter" data-level="9.7" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#what-if-we-considered-all-9-available-transformations-1"><i class="fa fa-check"></i><b>9.7</b> What if we considered all 9 available transformations?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html"><i class="fa fa-check"></i><b>10</b> Summarizing data within subgroups</a><ul>
<li class="chapter" data-level="10.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-dplyr-and-summarise-to-build-a-tibble-of-summary-information"><i class="fa fa-check"></i><b>10.1</b> Using dplyr and summarise to build a tibble of summary information</a></li>
<li class="chapter" data-level="10.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#another-example"><i class="fa fa-check"></i><b>10.2</b> Another Example</a></li>
<li class="chapter" data-level="10.3" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#boxplots-to-relate-an-outcome-to-a-categorical-predictor"><i class="fa fa-check"></i><b>10.3</b> Boxplots to Relate an Outcome to a Categorical Predictor</a><ul>
<li class="chapter" data-level="10.3.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#augmenting-the-boxplot-with-the-sample-mean"><i class="fa fa-check"></i><b>10.3.1</b> Augmenting the Boxplot with the Sample Mean</a></li>
<li class="chapter" data-level="10.3.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#building-a-violin-plot"><i class="fa fa-check"></i><b>10.3.2</b> Building a Violin Plot</a></li>
<li class="chapter" data-level="10.3.3" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#adding-notches-to-a-boxplot"><i class="fa fa-check"></i><b>10.3.3</b> Adding Notches to a Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-histograms-to-make-comparisons"><i class="fa fa-check"></i><b>10.4</b> Using Multiple Histograms to Make Comparisons</a></li>
<li class="chapter" data-level="10.5" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-density-plots-to-make-comparisons"><i class="fa fa-check"></i><b>10.5</b> Using Multiple Density Plots to Make Comparisons</a></li>
<li class="chapter" data-level="10.6" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#a-ridgeline-plot"><i class="fa fa-check"></i><b>10.6</b> A Ridgeline Plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-transformations-to-normalize-distributions" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Using Transformations to “Normalize” Distributions</h1>
<ul>
<li>When we are confronted with a variable that is not Normally distributed but that we wish was Normally distributed, it is sometimes useful to consider whether working with a transformation of the data will yield a more helpful result.</li>
<li>Many statistical methods, including t tests and analyses of variance, assume Normal distributions.</li>
<li>We’ll discuss using R to assess a range of what are called Box-Cox power transformations, via plots, mainly.</li>
</ul>
<div id="the-ladder-of-power-transformations" class="section level2">
<h2><span class="header-section-number">9.1</span> The Ladder of Power Transformations</h2>
<p>The key notion in re-expression of a single variable to obtain a distribution better approximated by the Normal or re-expression of an outcome in a simple regression model is that of a <strong>ladder of power transformations</strong>, which applies to any unimodal data.</p>
<table>
<thead>
<tr class="header">
<th align="center">Power</th>
<th align="center">Transformation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">3</td>
<td align="center">x<sup>3</sup></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">x<sup>2</sup></td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">x (unchanged)</td>
</tr>
<tr class="even">
<td align="center">0.5</td>
<td align="center">x<sup>0.5</sup> = <span class="math inline">\(\sqrt{x}\)</span></td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">ln x</td>
</tr>
<tr class="even">
<td align="center">-0.5</td>
<td align="center">x<sup>-0.5</sup> = 1/<span class="math inline">\(\sqrt{x}\)</span></td>
</tr>
<tr class="odd">
<td align="center">-1</td>
<td align="center">x<sup>-1</sup> = 1/x</td>
</tr>
<tr class="even">
<td align="center">-2</td>
<td align="center">x<sup>-2</sup> = 1/x<sup>2</sup></td>
</tr>
</tbody>
</table>
</div>
<div id="using-the-ladder" class="section level2">
<h2><span class="header-section-number">9.2</span> Using the Ladder</h2>
<p>As we move further away from the <em>identity</em> function (power = 1) we change the shape more and more in the same general direction.</p>
<ul>
<li>For instance, if we try a logarithm, and this seems like too much of a change, we might try a square root instead.</li>
<li>Note that this ladder (which like many other things is due to John Tukey) uses the logarithm for the “power zero” transformation rather than the constant, which is what x<sup>0</sup> actually is.</li>
<li>If the variable x can take on negative values, we might take a different approach. If x is a count of something that could be zero, we often simply add 1 to x before transformation.</li>
</ul>
<p>The ladder of power transformations is particularly helpful when we are confronted with data that shows skew.</p>
<ul>
<li>To handle right skew (where the mean exceeds the median) we usually apply powers below 1.</li>
<li>To handle left skew (where the median exceeds the mean) we usually apply powers greater than 1.</li>
</ul>
<p>The most common transformations are the square (power 2), the square root (power 1/2), the logarithm (power 0) and the inverse (power -1), and I usually restrict myself to those options in practical work.</p>
</div>
<div id="protein-consumption-in-the-nnyfs-data" class="section level2">
<h2><span class="header-section-number">9.3</span> Protein Consumption in the NNYFS data</h2>
<p>Here are the protein consumption (in grams) results from the NNYFS data.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="using-transformations-to-normalize-distributions.html#cb271-1"></a>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>protein, <span class="dt">data =</span> nnyfs)</span></code></pre></div>
<pre><code>  min    Q1 median     Q3    max     mean       sd    n missing
 4.18 45.33 61.255 82.565 241.84 66.90148 30.96319 1518       0</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="using-transformations-to-normalize-distributions.html#cb273-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;Protein&quot;</span>, <span class="dt">y =</span> protein)) <span class="op">+</span></span>
<span id="cb273-2"><a href="using-transformations-to-normalize-distributions.html#cb273-2"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb273-3"><a href="using-transformations-to-normalize-distributions.html#cb273-3"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </span>
<span id="cb273-4"><a href="using-transformations-to-normalize-distributions.html#cb273-4"></a>                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb273-5"><a href="using-transformations-to-normalize-distributions.html#cb273-5"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb273-6"><a href="using-transformations-to-normalize-distributions.html#cb273-6"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein consumption&quot;</span>,</span>
<span id="cb273-7"><a href="using-transformations-to-normalize-distributions.html#cb273-7"></a>         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</span>
<span id="cb273-8"><a href="using-transformations-to-normalize-distributions.html#cb273-8"></a></span>
<span id="cb273-9"><a href="using-transformations-to-normalize-distributions.html#cb273-9"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein)) <span class="op">+</span></span>
<span id="cb273-10"><a href="using-transformations-to-normalize-distributions.html#cb273-10"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb273-11"><a href="using-transformations-to-normalize-distributions.html#cb273-11"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb273-12"><a href="using-transformations-to-normalize-distributions.html#cb273-12"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb273-13"><a href="using-transformations-to-normalize-distributions.html#cb273-13"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein Consumption&quot;</span>,</span>
<span id="cb273-14"><a href="using-transformations-to-normalize-distributions.html#cb273-14"></a>         <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</span>
<span id="cb273-15"><a href="using-transformations-to-normalize-distributions.html#cb273-15"></a></span>
<span id="cb273-16"><a href="using-transformations-to-normalize-distributions.html#cb273-16"></a>p1 <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>The key point here is that we see several signs of meaningful right skew, and we’ll want to consider a transformation that might make a Normal model more plausible.</p>
<div id="using-patchwork-to-compose-plots" class="section level3">
<h3><span class="header-section-number">9.3.1</span> Using <code>patchwork</code> to compose plots</h3>
<p>For me, the slickest approach to composing how a series of plots are placed together is available in the <code>patchwork</code> package. Here’s another example.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="using-transformations-to-normalize-distributions.html#cb274-1"></a>res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>protein, <span class="dt">data =</span> nnyfs)</span>
<span id="cb274-2"><a href="using-transformations-to-normalize-distributions.html#cb274-2"></a>bin_w &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># specify binwidth</span></span>
<span id="cb274-3"><a href="using-transformations-to-normalize-distributions.html#cb274-3"></a></span>
<span id="cb274-4"><a href="using-transformations-to-normalize-distributions.html#cb274-4"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> protein)) <span class="op">+</span></span>
<span id="cb274-5"><a href="using-transformations-to-normalize-distributions.html#cb274-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </span>
<span id="cb274-6"><a href="using-transformations-to-normalize-distributions.html#cb274-6"></a>                   <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </span>
<span id="cb274-7"><a href="using-transformations-to-normalize-distributions.html#cb274-7"></a>                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb274-8"><a href="using-transformations-to-normalize-distributions.html#cb274-8"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb274-9"><a href="using-transformations-to-normalize-distributions.html#cb274-9"></a><span class="st">    </span><span class="kw">stat_function</span>(</span>
<span id="cb274-10"><a href="using-transformations-to-normalize-distributions.html#cb274-10"></a>        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </span>
<span id="cb274-11"><a href="using-transformations-to-normalize-distributions.html#cb274-11"></a>                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></span>
<span id="cb274-12"><a href="using-transformations-to-normalize-distributions.html#cb274-12"></a><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</span>
<span id="cb274-13"><a href="using-transformations-to-normalize-distributions.html#cb274-13"></a>        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb274-14"><a href="using-transformations-to-normalize-distributions.html#cb274-14"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </span>
<span id="cb274-15"><a href="using-transformations-to-normalize-distributions.html#cb274-15"></a>         <span class="dt">x =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</span>
<span id="cb274-16"><a href="using-transformations-to-normalize-distributions.html#cb274-16"></a></span>
<span id="cb274-17"><a href="using-transformations-to-normalize-distributions.html#cb274-17"></a></span>
<span id="cb274-18"><a href="using-transformations-to-normalize-distributions.html#cb274-18"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein)) <span class="op">+</span></span>
<span id="cb274-19"><a href="using-transformations-to-normalize-distributions.html#cb274-19"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb274-20"><a href="using-transformations-to-normalize-distributions.html#cb274-20"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb274-21"><a href="using-transformations-to-normalize-distributions.html#cb274-21"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb274-22"><a href="using-transformations-to-normalize-distributions.html#cb274-22"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</span>
<span id="cb274-23"><a href="using-transformations-to-normalize-distributions.html#cb274-23"></a>         <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</span>
<span id="cb274-24"><a href="using-transformations-to-normalize-distributions.html#cb274-24"></a></span>
<span id="cb274-25"><a href="using-transformations-to-normalize-distributions.html#cb274-25"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> protein)) <span class="op">+</span></span>
<span id="cb274-26"><a href="using-transformations-to-normalize-distributions.html#cb274-26"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb274-27"><a href="using-transformations-to-normalize-distributions.html#cb274-27"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </span>
<span id="cb274-28"><a href="using-transformations-to-normalize-distributions.html#cb274-28"></a>                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb274-29"><a href="using-transformations-to-normalize-distributions.html#cb274-29"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb274-30"><a href="using-transformations-to-normalize-distributions.html#cb274-30"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb274-31"><a href="using-transformations-to-normalize-distributions.html#cb274-31"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</span>
<span id="cb274-32"><a href="using-transformations-to-normalize-distributions.html#cb274-32"></a>         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</span>
<span id="cb274-33"><a href="using-transformations-to-normalize-distributions.html#cb274-33"></a></span>
<span id="cb274-34"><a href="using-transformations-to-normalize-distributions.html#cb274-34"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb274-35"><a href="using-transformations-to-normalize-distributions.html#cb274-35"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein Consumption&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>For more on the <code>patchwork</code> package, check out its repository at <a href="https://github.com/thomasp85/patchwork" class="uri">https://github.com/thomasp85/patchwork</a>.</p>
</div>
</div>
<div id="can-we-transform-the-protein-data" class="section level2">
<h2><span class="header-section-number">9.4</span> Can we transform the <code>protein</code> data?</h2>
<p>As we’ve seen, the <code>protein</code> data are right skewed, and all of the values are strictly positive. If we want to use the tools of the Normal distribution to describe these data, we might try taking a step “down” our ladder from power 1 (raw data) to lower powers.</p>
<div id="the-square-root" class="section level3">
<h3><span class="header-section-number">9.4.1</span> The Square Root</h3>
<p>Would a square root applied to the protein data help alleviate that right skew?</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="using-transformations-to-normalize-distributions.html#cb275-1"></a>res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span><span class="kw">sqrt</span>(protein), <span class="dt">data =</span> nnyfs)</span>
<span id="cb275-2"><a href="using-transformations-to-normalize-distributions.html#cb275-2"></a>bin_w &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># specify binwidth</span></span>
<span id="cb275-3"><a href="using-transformations-to-normalize-distributions.html#cb275-3"></a></span>
<span id="cb275-4"><a href="using-transformations-to-normalize-distributions.html#cb275-4"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></span>
<span id="cb275-5"><a href="using-transformations-to-normalize-distributions.html#cb275-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </span>
<span id="cb275-6"><a href="using-transformations-to-normalize-distributions.html#cb275-6"></a>                   <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </span>
<span id="cb275-7"><a href="using-transformations-to-normalize-distributions.html#cb275-7"></a>                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb275-8"><a href="using-transformations-to-normalize-distributions.html#cb275-8"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb275-9"><a href="using-transformations-to-normalize-distributions.html#cb275-9"></a><span class="st">    </span><span class="kw">stat_function</span>(</span>
<span id="cb275-10"><a href="using-transformations-to-normalize-distributions.html#cb275-10"></a>        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </span>
<span id="cb275-11"><a href="using-transformations-to-normalize-distributions.html#cb275-11"></a>                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></span>
<span id="cb275-12"><a href="using-transformations-to-normalize-distributions.html#cb275-12"></a><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</span>
<span id="cb275-13"><a href="using-transformations-to-normalize-distributions.html#cb275-13"></a>        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb275-14"><a href="using-transformations-to-normalize-distributions.html#cb275-14"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </span>
<span id="cb275-15"><a href="using-transformations-to-normalize-distributions.html#cb275-15"></a>         <span class="dt">x =</span> <span class="st">&quot;Square Root of Protein Consumption (g)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</span>
<span id="cb275-16"><a href="using-transformations-to-normalize-distributions.html#cb275-16"></a></span>
<span id="cb275-17"><a href="using-transformations-to-normalize-distributions.html#cb275-17"></a></span>
<span id="cb275-18"><a href="using-transformations-to-normalize-distributions.html#cb275-18"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></span>
<span id="cb275-19"><a href="using-transformations-to-normalize-distributions.html#cb275-19"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb275-20"><a href="using-transformations-to-normalize-distributions.html#cb275-20"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb275-21"><a href="using-transformations-to-normalize-distributions.html#cb275-21"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb275-22"><a href="using-transformations-to-normalize-distributions.html#cb275-22"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</span>
<span id="cb275-23"><a href="using-transformations-to-normalize-distributions.html#cb275-23"></a>         <span class="dt">y =</span> <span class="st">&quot;Square Root of Protein Consumption (g)&quot;</span>)</span>
<span id="cb275-24"><a href="using-transformations-to-normalize-distributions.html#cb275-24"></a></span>
<span id="cb275-25"><a href="using-transformations-to-normalize-distributions.html#cb275-25"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></span>
<span id="cb275-26"><a href="using-transformations-to-normalize-distributions.html#cb275-26"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb275-27"><a href="using-transformations-to-normalize-distributions.html#cb275-27"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </span>
<span id="cb275-28"><a href="using-transformations-to-normalize-distributions.html#cb275-28"></a>                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb275-29"><a href="using-transformations-to-normalize-distributions.html#cb275-29"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb275-30"><a href="using-transformations-to-normalize-distributions.html#cb275-30"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb275-31"><a href="using-transformations-to-normalize-distributions.html#cb275-31"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</span>
<span id="cb275-32"><a href="using-transformations-to-normalize-distributions.html#cb275-32"></a>         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Square Root of Protein Consumption (g)&quot;</span>)</span>
<span id="cb275-33"><a href="using-transformations-to-normalize-distributions.html#cb275-33"></a></span>
<span id="cb275-34"><a href="using-transformations-to-normalize-distributions.html#cb275-34"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb275-35"><a href="using-transformations-to-normalize-distributions.html#cb275-35"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Square Root of NNYFS Protein Consumption&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>That looks like a more symmetric distribution, certainly, although we still have some outliers on the right side of the distribution. Should we take another step down the ladder?</p>
</div>
<div id="the-logarithm" class="section level3">
<h3><span class="header-section-number">9.4.2</span> The Logarithm</h3>
<p>We might also try a logarithm of the energy circumference data. We can use either the natural logarithm (log, in R) or the base-10 logarithm (log10, in R) - either will have the same impact on skew.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="using-transformations-to-normalize-distributions.html#cb276-1"></a>res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span><span class="kw">log</span>(protein), <span class="dt">data =</span> nnyfs)</span>
<span id="cb276-2"><a href="using-transformations-to-normalize-distributions.html#cb276-2"></a>bin_w &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co"># specify binwidth</span></span>
<span id="cb276-3"><a href="using-transformations-to-normalize-distributions.html#cb276-3"></a></span>
<span id="cb276-4"><a href="using-transformations-to-normalize-distributions.html#cb276-4"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></span>
<span id="cb276-5"><a href="using-transformations-to-normalize-distributions.html#cb276-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </span>
<span id="cb276-6"><a href="using-transformations-to-normalize-distributions.html#cb276-6"></a>                   <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </span>
<span id="cb276-7"><a href="using-transformations-to-normalize-distributions.html#cb276-7"></a>                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb276-8"><a href="using-transformations-to-normalize-distributions.html#cb276-8"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb276-9"><a href="using-transformations-to-normalize-distributions.html#cb276-9"></a><span class="st">    </span><span class="kw">stat_function</span>(</span>
<span id="cb276-10"><a href="using-transformations-to-normalize-distributions.html#cb276-10"></a>        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </span>
<span id="cb276-11"><a href="using-transformations-to-normalize-distributions.html#cb276-11"></a>                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></span>
<span id="cb276-12"><a href="using-transformations-to-normalize-distributions.html#cb276-12"></a><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</span>
<span id="cb276-13"><a href="using-transformations-to-normalize-distributions.html#cb276-13"></a>        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb276-14"><a href="using-transformations-to-normalize-distributions.html#cb276-14"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </span>
<span id="cb276-15"><a href="using-transformations-to-normalize-distributions.html#cb276-15"></a>         <span class="dt">x =</span> <span class="st">&quot;Log of Protein Consumption (g)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</span>
<span id="cb276-16"><a href="using-transformations-to-normalize-distributions.html#cb276-16"></a></span>
<span id="cb276-17"><a href="using-transformations-to-normalize-distributions.html#cb276-17"></a></span>
<span id="cb276-18"><a href="using-transformations-to-normalize-distributions.html#cb276-18"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></span>
<span id="cb276-19"><a href="using-transformations-to-normalize-distributions.html#cb276-19"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb276-20"><a href="using-transformations-to-normalize-distributions.html#cb276-20"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb276-21"><a href="using-transformations-to-normalize-distributions.html#cb276-21"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb276-22"><a href="using-transformations-to-normalize-distributions.html#cb276-22"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</span>
<span id="cb276-23"><a href="using-transformations-to-normalize-distributions.html#cb276-23"></a>         <span class="dt">y =</span> <span class="st">&quot;Log of Protein Consumption (g)&quot;</span>)</span>
<span id="cb276-24"><a href="using-transformations-to-normalize-distributions.html#cb276-24"></a></span>
<span id="cb276-25"><a href="using-transformations-to-normalize-distributions.html#cb276-25"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></span>
<span id="cb276-26"><a href="using-transformations-to-normalize-distributions.html#cb276-26"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb276-27"><a href="using-transformations-to-normalize-distributions.html#cb276-27"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </span>
<span id="cb276-28"><a href="using-transformations-to-normalize-distributions.html#cb276-28"></a>                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb276-29"><a href="using-transformations-to-normalize-distributions.html#cb276-29"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb276-30"><a href="using-transformations-to-normalize-distributions.html#cb276-30"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb276-31"><a href="using-transformations-to-normalize-distributions.html#cb276-31"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</span>
<span id="cb276-32"><a href="using-transformations-to-normalize-distributions.html#cb276-32"></a>         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Log of Protein Consumption (g)&quot;</span>)</span>
<span id="cb276-33"><a href="using-transformations-to-normalize-distributions.html#cb276-33"></a></span>
<span id="cb276-34"><a href="using-transformations-to-normalize-distributions.html#cb276-34"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb276-35"><a href="using-transformations-to-normalize-distributions.html#cb276-35"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Logarithm of NNYFS Protein Consumption&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Now, it looks like we may have gone too far in the other direction. It looks like the square root is a sensible choice to try to improve the fit of a Normal model to the protein consumption data.</p>
</div>
<div id="this-course-uses-natural-logarithms-unless-otherwise-specified" class="section level3">
<h3><span class="header-section-number">9.4.3</span> This course uses Natural Logarithms, unless otherwise specified</h3>
<p>In this course, we will assume the use of natural logarithms unless we specify otherwise. Following R’s convention, we will use <code>log</code> for natural logarithms.</p>
</div>
</div>
<div id="what-if-we-considered-all-9-available-transformations" class="section level2">
<h2><span class="header-section-number">9.5</span> What if we considered all 9 available transformations?</h2>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="using-transformations-to-normalize-distributions.html#cb277-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></span>
<span id="cb277-2"><a href="using-transformations-to-normalize-distributions.html#cb277-2"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-3"><a href="using-transformations-to-normalize-distributions.html#cb277-3"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-4"><a href="using-transformations-to-normalize-distributions.html#cb277-4"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-5"><a href="using-transformations-to-normalize-distributions.html#cb277-5"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Cube (power 3)&quot;</span>,</span>
<span id="cb277-6"><a href="using-transformations-to-normalize-distributions.html#cb277-6"></a>         <span class="dt">y =</span> <span class="st">&quot;Protein, Cubed&quot;</span>)</span>
<span id="cb277-7"><a href="using-transformations-to-normalize-distributions.html#cb277-7"></a></span>
<span id="cb277-8"><a href="using-transformations-to-normalize-distributions.html#cb277-8"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb277-9"><a href="using-transformations-to-normalize-distributions.html#cb277-9"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-10"><a href="using-transformations-to-normalize-distributions.html#cb277-10"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-11"><a href="using-transformations-to-normalize-distributions.html#cb277-11"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-12"><a href="using-transformations-to-normalize-distributions.html#cb277-12"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Square (power 2)&quot;</span>,</span>
<span id="cb277-13"><a href="using-transformations-to-normalize-distributions.html#cb277-13"></a>         <span class="dt">y =</span> <span class="st">&quot;Protein, Squared&quot;</span>)</span>
<span id="cb277-14"><a href="using-transformations-to-normalize-distributions.html#cb277-14"></a></span>
<span id="cb277-15"><a href="using-transformations-to-normalize-distributions.html#cb277-15"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein)) <span class="op">+</span></span>
<span id="cb277-16"><a href="using-transformations-to-normalize-distributions.html#cb277-16"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-17"><a href="using-transformations-to-normalize-distributions.html#cb277-17"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-18"><a href="using-transformations-to-normalize-distributions.html#cb277-18"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-19"><a href="using-transformations-to-normalize-distributions.html#cb277-19"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Original Data&quot;</span>,</span>
<span id="cb277-20"><a href="using-transformations-to-normalize-distributions.html#cb277-20"></a>         <span class="dt">y =</span> <span class="st">&quot;Protein (g)&quot;</span>)</span>
<span id="cb277-21"><a href="using-transformations-to-normalize-distributions.html#cb277-21"></a></span>
<span id="cb277-22"><a href="using-transformations-to-normalize-distributions.html#cb277-22"></a></span>
<span id="cb277-23"><a href="using-transformations-to-normalize-distributions.html#cb277-23"></a>p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></span>
<span id="cb277-24"><a href="using-transformations-to-normalize-distributions.html#cb277-24"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-25"><a href="using-transformations-to-normalize-distributions.html#cb277-25"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-26"><a href="using-transformations-to-normalize-distributions.html#cb277-26"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-27"><a href="using-transformations-to-normalize-distributions.html#cb277-27"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sqrt (power 0.5)&quot;</span>,</span>
<span id="cb277-28"><a href="using-transformations-to-normalize-distributions.html#cb277-28"></a>         <span class="dt">y =</span> <span class="st">&quot;Square Root of Protein&quot;</span>)</span>
<span id="cb277-29"><a href="using-transformations-to-normalize-distributions.html#cb277-29"></a></span>
<span id="cb277-30"><a href="using-transformations-to-normalize-distributions.html#cb277-30"></a>p5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></span>
<span id="cb277-31"><a href="using-transformations-to-normalize-distributions.html#cb277-31"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-32"><a href="using-transformations-to-normalize-distributions.html#cb277-32"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-33"><a href="using-transformations-to-normalize-distributions.html#cb277-33"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-34"><a href="using-transformations-to-normalize-distributions.html#cb277-34"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;log (power 0)&quot;</span>,</span>
<span id="cb277-35"><a href="using-transformations-to-normalize-distributions.html#cb277-35"></a>         <span class="dt">y =</span> <span class="st">&quot;Natural Log of Protein&quot;</span>)</span>
<span id="cb277-36"><a href="using-transformations-to-normalize-distributions.html#cb277-36"></a></span>
<span id="cb277-37"><a href="using-transformations-to-normalize-distributions.html#cb277-37"></a>p6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein<span class="op">^</span>(<span class="op">-</span><span class="fl">0.5</span>))) <span class="op">+</span></span>
<span id="cb277-38"><a href="using-transformations-to-normalize-distributions.html#cb277-38"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-39"><a href="using-transformations-to-normalize-distributions.html#cb277-39"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-40"><a href="using-transformations-to-normalize-distributions.html#cb277-40"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-41"><a href="using-transformations-to-normalize-distributions.html#cb277-41"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/sqrt (power -0.5)&quot;</span>,</span>
<span id="cb277-42"><a href="using-transformations-to-normalize-distributions.html#cb277-42"></a>         <span class="dt">y =</span> <span class="st">&quot;1/Square Root(Protein)&quot;</span>)</span>
<span id="cb277-43"><a href="using-transformations-to-normalize-distributions.html#cb277-43"></a></span>
<span id="cb277-44"><a href="using-transformations-to-normalize-distributions.html#cb277-44"></a></span>
<span id="cb277-45"><a href="using-transformations-to-normalize-distributions.html#cb277-45"></a>p7 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>protein)) <span class="op">+</span></span>
<span id="cb277-46"><a href="using-transformations-to-normalize-distributions.html#cb277-46"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-47"><a href="using-transformations-to-normalize-distributions.html#cb277-47"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-48"><a href="using-transformations-to-normalize-distributions.html#cb277-48"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-49"><a href="using-transformations-to-normalize-distributions.html#cb277-49"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Inverse (power -1)&quot;</span>,</span>
<span id="cb277-50"><a href="using-transformations-to-normalize-distributions.html#cb277-50"></a>         <span class="dt">y =</span> <span class="st">&quot;1/Protein&quot;</span>)</span>
<span id="cb277-51"><a href="using-transformations-to-normalize-distributions.html#cb277-51"></a></span>
<span id="cb277-52"><a href="using-transformations-to-normalize-distributions.html#cb277-52"></a>p8 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(protein<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></span>
<span id="cb277-53"><a href="using-transformations-to-normalize-distributions.html#cb277-53"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-54"><a href="using-transformations-to-normalize-distributions.html#cb277-54"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-55"><a href="using-transformations-to-normalize-distributions.html#cb277-55"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-56"><a href="using-transformations-to-normalize-distributions.html#cb277-56"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Square (power -2)&quot;</span>,</span>
<span id="cb277-57"><a href="using-transformations-to-normalize-distributions.html#cb277-57"></a>         <span class="dt">y =</span> <span class="st">&quot;1 /(Protein squared)&quot;</span>)</span>
<span id="cb277-58"><a href="using-transformations-to-normalize-distributions.html#cb277-58"></a></span>
<span id="cb277-59"><a href="using-transformations-to-normalize-distributions.html#cb277-59"></a>p9 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(protein<span class="op">^</span><span class="dv">3</span>))) <span class="op">+</span></span>
<span id="cb277-60"><a href="using-transformations-to-normalize-distributions.html#cb277-60"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-61"><a href="using-transformations-to-normalize-distributions.html#cb277-61"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb277-62"><a href="using-transformations-to-normalize-distributions.html#cb277-62"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb277-63"><a href="using-transformations-to-normalize-distributions.html#cb277-63"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Cube (power -3)&quot;</span>,</span>
<span id="cb277-64"><a href="using-transformations-to-normalize-distributions.html#cb277-64"></a>         <span class="dt">y =</span> <span class="st">&quot;1/(Protein cubed)&quot;</span>)</span>
<span id="cb277-65"><a href="using-transformations-to-normalize-distributions.html#cb277-65"></a></span>
<span id="cb277-66"><a href="using-transformations-to-normalize-distributions.html#cb277-66"></a></span>
<span id="cb277-67"><a href="using-transformations-to-normalize-distributions.html#cb277-67"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span>p4 <span class="op">+</span><span class="st"> </span>p5 <span class="op">+</span><span class="st"> </span>p6 <span class="op">+</span><span class="st"> </span>p7 <span class="op">+</span><span class="st"> </span>p8 <span class="op">+</span><span class="st"> </span>p9 <span class="op">+</span></span>
<span id="cb277-68"><a href="using-transformations-to-normalize-distributions.html#cb277-68"></a><span class="st">    </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb277-69"><a href="using-transformations-to-normalize-distributions.html#cb277-69"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Transformations of NNYFS Protein Consumption&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>The square root still appears to be the best choice of transformation here, even after we consider all 8 transformation of the raw data.</p>
</div>
<div id="a-simulated-data-set" class="section level2">
<h2><span class="header-section-number">9.6</span> A Simulated Data Set</h2>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="using-transformations-to-normalize-distributions.html#cb278-1"></a><span class="kw">set.seed</span>(<span class="dv">431</span>); </span>
<span id="cb278-2"><a href="using-transformations-to-normalize-distributions.html#cb278-2"></a>data2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample2 =</span> <span class="dv">100</span><span class="op">*</span><span class="kw">rbeta</span>(<span class="dt">n =</span> <span class="dv">125</span>, <span class="dt">shape1 =</span> <span class="dv">5</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>))</span></code></pre></div>
<p>If we’d like to transform these data so as to better approximate a Normal distribution, where should we start? What transformation do you suggest?</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="using-transformations-to-normalize-distributions.html#cb279-1"></a>res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>sample2, <span class="dt">data =</span> data2)</span>
<span id="cb279-2"><a href="using-transformations-to-normalize-distributions.html#cb279-2"></a>bin_w &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># specify binwidth</span></span>
<span id="cb279-3"><a href="using-transformations-to-normalize-distributions.html#cb279-3"></a></span>
<span id="cb279-4"><a href="using-transformations-to-normalize-distributions.html#cb279-4"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> sample2)) <span class="op">+</span></span>
<span id="cb279-5"><a href="using-transformations-to-normalize-distributions.html#cb279-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </span>
<span id="cb279-6"><a href="using-transformations-to-normalize-distributions.html#cb279-6"></a>                   <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </span>
<span id="cb279-7"><a href="using-transformations-to-normalize-distributions.html#cb279-7"></a>                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb279-8"><a href="using-transformations-to-normalize-distributions.html#cb279-8"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb279-9"><a href="using-transformations-to-normalize-distributions.html#cb279-9"></a><span class="st">    </span><span class="kw">stat_function</span>(</span>
<span id="cb279-10"><a href="using-transformations-to-normalize-distributions.html#cb279-10"></a>        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </span>
<span id="cb279-11"><a href="using-transformations-to-normalize-distributions.html#cb279-11"></a>                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></span>
<span id="cb279-12"><a href="using-transformations-to-normalize-distributions.html#cb279-12"></a><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</span>
<span id="cb279-13"><a href="using-transformations-to-normalize-distributions.html#cb279-13"></a>        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb279-14"><a href="using-transformations-to-normalize-distributions.html#cb279-14"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </span>
<span id="cb279-15"><a href="using-transformations-to-normalize-distributions.html#cb279-15"></a>         <span class="dt">x =</span> <span class="st">&quot;Simulated Data&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</span>
<span id="cb279-16"><a href="using-transformations-to-normalize-distributions.html#cb279-16"></a></span>
<span id="cb279-17"><a href="using-transformations-to-normalize-distributions.html#cb279-17"></a></span>
<span id="cb279-18"><a href="using-transformations-to-normalize-distributions.html#cb279-18"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2)) <span class="op">+</span></span>
<span id="cb279-19"><a href="using-transformations-to-normalize-distributions.html#cb279-19"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb279-20"><a href="using-transformations-to-normalize-distributions.html#cb279-20"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb279-21"><a href="using-transformations-to-normalize-distributions.html#cb279-21"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb279-22"><a href="using-transformations-to-normalize-distributions.html#cb279-22"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</span>
<span id="cb279-23"><a href="using-transformations-to-normalize-distributions.html#cb279-23"></a>         <span class="dt">y =</span> <span class="st">&quot;Simulated Data&quot;</span>)</span>
<span id="cb279-24"><a href="using-transformations-to-normalize-distributions.html#cb279-24"></a></span>
<span id="cb279-25"><a href="using-transformations-to-normalize-distributions.html#cb279-25"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> sample2)) <span class="op">+</span></span>
<span id="cb279-26"><a href="using-transformations-to-normalize-distributions.html#cb279-26"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb279-27"><a href="using-transformations-to-normalize-distributions.html#cb279-27"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </span>
<span id="cb279-28"><a href="using-transformations-to-normalize-distributions.html#cb279-28"></a>                 <span class="dt">outlier.color =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span></span>
<span id="cb279-29"><a href="using-transformations-to-normalize-distributions.html#cb279-29"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb279-30"><a href="using-transformations-to-normalize-distributions.html#cb279-30"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb279-31"><a href="using-transformations-to-normalize-distributions.html#cb279-31"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</span>
<span id="cb279-32"><a href="using-transformations-to-normalize-distributions.html#cb279-32"></a>         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Simulated Data&quot;</span>)</span>
<span id="cb279-33"><a href="using-transformations-to-normalize-distributions.html#cb279-33"></a></span>
<span id="cb279-34"><a href="using-transformations-to-normalize-distributions.html#cb279-34"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb279-35"><a href="using-transformations-to-normalize-distributions.html#cb279-35"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Simulated Data&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>Given the left skew in the data, it looks like a step up in the ladder is warranted, perhaps by looking at the square of the data?</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="using-transformations-to-normalize-distributions.html#cb280-1"></a>res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>sample2<span class="op">^</span><span class="dv">2</span>, <span class="dt">data =</span> data2)</span>
<span id="cb280-2"><a href="using-transformations-to-normalize-distributions.html#cb280-2"></a>bin_w &lt;-<span class="st"> </span><span class="dv">600</span> <span class="co"># specify binwidth</span></span>
<span id="cb280-3"><a href="using-transformations-to-normalize-distributions.html#cb280-3"></a></span>
<span id="cb280-4"><a href="using-transformations-to-normalize-distributions.html#cb280-4"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb280-5"><a href="using-transformations-to-normalize-distributions.html#cb280-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </span>
<span id="cb280-6"><a href="using-transformations-to-normalize-distributions.html#cb280-6"></a>                   <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </span>
<span id="cb280-7"><a href="using-transformations-to-normalize-distributions.html#cb280-7"></a>                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb280-8"><a href="using-transformations-to-normalize-distributions.html#cb280-8"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb280-9"><a href="using-transformations-to-normalize-distributions.html#cb280-9"></a><span class="st">    </span><span class="kw">stat_function</span>(</span>
<span id="cb280-10"><a href="using-transformations-to-normalize-distributions.html#cb280-10"></a>        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </span>
<span id="cb280-11"><a href="using-transformations-to-normalize-distributions.html#cb280-11"></a>                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></span>
<span id="cb280-12"><a href="using-transformations-to-normalize-distributions.html#cb280-12"></a><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</span>
<span id="cb280-13"><a href="using-transformations-to-normalize-distributions.html#cb280-13"></a>        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb280-14"><a href="using-transformations-to-normalize-distributions.html#cb280-14"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </span>
<span id="cb280-15"><a href="using-transformations-to-normalize-distributions.html#cb280-15"></a>         <span class="dt">x =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</span>
<span id="cb280-16"><a href="using-transformations-to-normalize-distributions.html#cb280-16"></a></span>
<span id="cb280-17"><a href="using-transformations-to-normalize-distributions.html#cb280-17"></a></span>
<span id="cb280-18"><a href="using-transformations-to-normalize-distributions.html#cb280-18"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb280-19"><a href="using-transformations-to-normalize-distributions.html#cb280-19"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb280-20"><a href="using-transformations-to-normalize-distributions.html#cb280-20"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb280-21"><a href="using-transformations-to-normalize-distributions.html#cb280-21"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb280-22"><a href="using-transformations-to-normalize-distributions.html#cb280-22"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</span>
<span id="cb280-23"><a href="using-transformations-to-normalize-distributions.html#cb280-23"></a>         <span class="dt">y =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>)</span>
<span id="cb280-24"><a href="using-transformations-to-normalize-distributions.html#cb280-24"></a></span>
<span id="cb280-25"><a href="using-transformations-to-normalize-distributions.html#cb280-25"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb280-26"><a href="using-transformations-to-normalize-distributions.html#cb280-26"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb280-27"><a href="using-transformations-to-normalize-distributions.html#cb280-27"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </span>
<span id="cb280-28"><a href="using-transformations-to-normalize-distributions.html#cb280-28"></a>                 <span class="dt">outlier.color =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span></span>
<span id="cb280-29"><a href="using-transformations-to-normalize-distributions.html#cb280-29"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb280-30"><a href="using-transformations-to-normalize-distributions.html#cb280-30"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb280-31"><a href="using-transformations-to-normalize-distributions.html#cb280-31"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</span>
<span id="cb280-32"><a href="using-transformations-to-normalize-distributions.html#cb280-32"></a>         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>)</span>
<span id="cb280-33"><a href="using-transformations-to-normalize-distributions.html#cb280-33"></a></span>
<span id="cb280-34"><a href="using-transformations-to-normalize-distributions.html#cb280-34"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb280-35"><a href="using-transformations-to-normalize-distributions.html#cb280-35"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>Looks like at best a modest improvement. How about cubing the data, instead?</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="using-transformations-to-normalize-distributions.html#cb281-1"></a>res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>sample2<span class="op">^</span><span class="dv">3</span>, <span class="dt">data =</span> data2)</span>
<span id="cb281-2"><a href="using-transformations-to-normalize-distributions.html#cb281-2"></a>bin_w &lt;-<span class="st"> </span><span class="dv">100000</span> <span class="co"># specify binwidth</span></span>
<span id="cb281-3"><a href="using-transformations-to-normalize-distributions.html#cb281-3"></a></span>
<span id="cb281-4"><a href="using-transformations-to-normalize-distributions.html#cb281-4"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></span>
<span id="cb281-5"><a href="using-transformations-to-normalize-distributions.html#cb281-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </span>
<span id="cb281-6"><a href="using-transformations-to-normalize-distributions.html#cb281-6"></a>                   <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </span>
<span id="cb281-7"><a href="using-transformations-to-normalize-distributions.html#cb281-7"></a>                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb281-8"><a href="using-transformations-to-normalize-distributions.html#cb281-8"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb281-9"><a href="using-transformations-to-normalize-distributions.html#cb281-9"></a><span class="st">    </span><span class="kw">stat_function</span>(</span>
<span id="cb281-10"><a href="using-transformations-to-normalize-distributions.html#cb281-10"></a>        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </span>
<span id="cb281-11"><a href="using-transformations-to-normalize-distributions.html#cb281-11"></a>                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></span>
<span id="cb281-12"><a href="using-transformations-to-normalize-distributions.html#cb281-12"></a><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</span>
<span id="cb281-13"><a href="using-transformations-to-normalize-distributions.html#cb281-13"></a>        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb281-14"><a href="using-transformations-to-normalize-distributions.html#cb281-14"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </span>
<span id="cb281-15"><a href="using-transformations-to-normalize-distributions.html#cb281-15"></a>         <span class="dt">x =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</span>
<span id="cb281-16"><a href="using-transformations-to-normalize-distributions.html#cb281-16"></a></span>
<span id="cb281-17"><a href="using-transformations-to-normalize-distributions.html#cb281-17"></a></span>
<span id="cb281-18"><a href="using-transformations-to-normalize-distributions.html#cb281-18"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></span>
<span id="cb281-19"><a href="using-transformations-to-normalize-distributions.html#cb281-19"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb281-20"><a href="using-transformations-to-normalize-distributions.html#cb281-20"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb281-21"><a href="using-transformations-to-normalize-distributions.html#cb281-21"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb281-22"><a href="using-transformations-to-normalize-distributions.html#cb281-22"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</span>
<span id="cb281-23"><a href="using-transformations-to-normalize-distributions.html#cb281-23"></a>         <span class="dt">y =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>)</span>
<span id="cb281-24"><a href="using-transformations-to-normalize-distributions.html#cb281-24"></a></span>
<span id="cb281-25"><a href="using-transformations-to-normalize-distributions.html#cb281-25"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></span>
<span id="cb281-26"><a href="using-transformations-to-normalize-distributions.html#cb281-26"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb281-27"><a href="using-transformations-to-normalize-distributions.html#cb281-27"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </span>
<span id="cb281-28"><a href="using-transformations-to-normalize-distributions.html#cb281-28"></a>                 <span class="dt">outlier.color =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span></span>
<span id="cb281-29"><a href="using-transformations-to-normalize-distributions.html#cb281-29"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb281-30"><a href="using-transformations-to-normalize-distributions.html#cb281-30"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb281-31"><a href="using-transformations-to-normalize-distributions.html#cb281-31"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</span>
<span id="cb281-32"><a href="using-transformations-to-normalize-distributions.html#cb281-32"></a>         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>)</span>
<span id="cb281-33"><a href="using-transformations-to-normalize-distributions.html#cb281-33"></a></span>
<span id="cb281-34"><a href="using-transformations-to-normalize-distributions.html#cb281-34"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb281-35"><a href="using-transformations-to-normalize-distributions.html#cb281-35"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>The newly transformed (cube of the) data appears more symmetric, although somewhat light-tailed. Perhaps a Normal model would be more appropriate now, although the standard deviation is likely to overstate the variation we see in the data due to the light tails. Again, I wouldn’t be thrilled using a cube in practical work, as it is so hard to interpret, but it does look like a reasonable choice here.</p>
</div>
<div id="what-if-we-considered-all-9-available-transformations-1" class="section level2">
<h2><span class="header-section-number">9.7</span> What if we considered all 9 available transformations?</h2>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="using-transformations-to-normalize-distributions.html#cb282-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></span>
<span id="cb282-2"><a href="using-transformations-to-normalize-distributions.html#cb282-2"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-3"><a href="using-transformations-to-normalize-distributions.html#cb282-3"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-4"><a href="using-transformations-to-normalize-distributions.html#cb282-4"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-5"><a href="using-transformations-to-normalize-distributions.html#cb282-5"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Cube (power 3)&quot;</span>)</span>
<span id="cb282-6"><a href="using-transformations-to-normalize-distributions.html#cb282-6"></a></span>
<span id="cb282-7"><a href="using-transformations-to-normalize-distributions.html#cb282-7"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb282-8"><a href="using-transformations-to-normalize-distributions.html#cb282-8"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-9"><a href="using-transformations-to-normalize-distributions.html#cb282-9"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-10"><a href="using-transformations-to-normalize-distributions.html#cb282-10"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-11"><a href="using-transformations-to-normalize-distributions.html#cb282-11"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Square (power 2)&quot;</span>)</span>
<span id="cb282-12"><a href="using-transformations-to-normalize-distributions.html#cb282-12"></a></span>
<span id="cb282-13"><a href="using-transformations-to-normalize-distributions.html#cb282-13"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2)) <span class="op">+</span></span>
<span id="cb282-14"><a href="using-transformations-to-normalize-distributions.html#cb282-14"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-15"><a href="using-transformations-to-normalize-distributions.html#cb282-15"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-16"><a href="using-transformations-to-normalize-distributions.html#cb282-16"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-17"><a href="using-transformations-to-normalize-distributions.html#cb282-17"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Original Data&quot;</span>)</span>
<span id="cb282-18"><a href="using-transformations-to-normalize-distributions.html#cb282-18"></a></span>
<span id="cb282-19"><a href="using-transformations-to-normalize-distributions.html#cb282-19"></a>p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">sqrt</span>(sample2))) <span class="op">+</span></span>
<span id="cb282-20"><a href="using-transformations-to-normalize-distributions.html#cb282-20"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-21"><a href="using-transformations-to-normalize-distributions.html#cb282-21"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-22"><a href="using-transformations-to-normalize-distributions.html#cb282-22"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-23"><a href="using-transformations-to-normalize-distributions.html#cb282-23"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sqrt (power 0.5)&quot;</span>)</span>
<span id="cb282-24"><a href="using-transformations-to-normalize-distributions.html#cb282-24"></a></span>
<span id="cb282-25"><a href="using-transformations-to-normalize-distributions.html#cb282-25"></a>p5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(sample2))) <span class="op">+</span></span>
<span id="cb282-26"><a href="using-transformations-to-normalize-distributions.html#cb282-26"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-27"><a href="using-transformations-to-normalize-distributions.html#cb282-27"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-28"><a href="using-transformations-to-normalize-distributions.html#cb282-28"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-29"><a href="using-transformations-to-normalize-distributions.html#cb282-29"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;log (power 0)&quot;</span>)</span>
<span id="cb282-30"><a href="using-transformations-to-normalize-distributions.html#cb282-30"></a></span>
<span id="cb282-31"><a href="using-transformations-to-normalize-distributions.html#cb282-31"></a>p6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span>(<span class="fl">0.5</span>))) <span class="op">+</span></span>
<span id="cb282-32"><a href="using-transformations-to-normalize-distributions.html#cb282-32"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-33"><a href="using-transformations-to-normalize-distributions.html#cb282-33"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-34"><a href="using-transformations-to-normalize-distributions.html#cb282-34"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-35"><a href="using-transformations-to-normalize-distributions.html#cb282-35"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/sqrt (power -0.5)&quot;</span>)</span>
<span id="cb282-36"><a href="using-transformations-to-normalize-distributions.html#cb282-36"></a></span>
<span id="cb282-37"><a href="using-transformations-to-normalize-distributions.html#cb282-37"></a>p7 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>sample2)) <span class="op">+</span></span>
<span id="cb282-38"><a href="using-transformations-to-normalize-distributions.html#cb282-38"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-39"><a href="using-transformations-to-normalize-distributions.html#cb282-39"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-40"><a href="using-transformations-to-normalize-distributions.html#cb282-40"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-41"><a href="using-transformations-to-normalize-distributions.html#cb282-41"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Inverse (power -1)&quot;</span>)</span>
<span id="cb282-42"><a href="using-transformations-to-normalize-distributions.html#cb282-42"></a></span>
<span id="cb282-43"><a href="using-transformations-to-normalize-distributions.html#cb282-43"></a>p8 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(sample2<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></span>
<span id="cb282-44"><a href="using-transformations-to-normalize-distributions.html#cb282-44"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-45"><a href="using-transformations-to-normalize-distributions.html#cb282-45"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-46"><a href="using-transformations-to-normalize-distributions.html#cb282-46"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-47"><a href="using-transformations-to-normalize-distributions.html#cb282-47"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Square (power -2)&quot;</span>)</span>
<span id="cb282-48"><a href="using-transformations-to-normalize-distributions.html#cb282-48"></a></span>
<span id="cb282-49"><a href="using-transformations-to-normalize-distributions.html#cb282-49"></a>p9 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(sample2<span class="op">^</span><span class="dv">3</span>))) <span class="op">+</span></span>
<span id="cb282-50"><a href="using-transformations-to-normalize-distributions.html#cb282-50"></a><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-51"><a href="using-transformations-to-normalize-distributions.html#cb282-51"></a><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb282-52"><a href="using-transformations-to-normalize-distributions.html#cb282-52"></a><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb282-53"><a href="using-transformations-to-normalize-distributions.html#cb282-53"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Cube (power -3)&quot;</span>)</span>
<span id="cb282-54"><a href="using-transformations-to-normalize-distributions.html#cb282-54"></a></span>
<span id="cb282-55"><a href="using-transformations-to-normalize-distributions.html#cb282-55"></a></span>
<span id="cb282-56"><a href="using-transformations-to-normalize-distributions.html#cb282-56"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span>p4 <span class="op">+</span><span class="st"> </span>p5 <span class="op">+</span><span class="st"> </span>p6 <span class="op">+</span><span class="st"> </span>p7 <span class="op">+</span><span class="st"> </span>p8 <span class="op">+</span><span class="st"> </span>p9 <span class="op">+</span></span>
<span id="cb282-57"><a href="using-transformations-to-normalize-distributions.html#cb282-57"></a><span class="st">    </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb282-58"><a href="using-transformations-to-normalize-distributions.html#cb282-58"></a><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Transformations of Simulated Sample&quot;</span>)</span></code></pre></div>
<p><img src="431-notes_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>Again, either the cube or the square looks like best choice here, in terms of creating a more symmetric (albeit light-tailed) distribution.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="using-transformations-to-normalize-distributions.html#cb283-1"></a><span class="kw">rm</span>(p1, p2, p3, p4, p5, p6, p7, p8, p9, res, bin_w, data2)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="assessing-normality.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summarizing-data-within-subgroups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/09_transformations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["431-notes.pdf", "431-notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
